<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>ãã‚…ãã‚…ã£ã¨NEWS</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&display=swap" rel="stylesheet">

<!-- Vue 3 æœ¬ç•ªãƒ“ãƒ«ãƒ‰ CDN -->
<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

<style>
/* ---------- CSS Variables ---------- */
:root {
  --primary-light: #E0F7FF;
  --primary-medium: #B8E6FF;
  --primary-dark: #87CEEB;
  --primary-accent: #5BA8C4;
  --background-gradient: linear-gradient(135deg, #E0F7FF 0%, #F0FBFF 100%);
  --card-shadow: 0 4px 20px rgba(91, 168, 196, 0.12);
  --card-shadow-hover: 0 8px 30px rgba(91, 168, 196, 0.2);
  --text-primary: #2C3E50;
  --text-secondary: #5A6C7D;
  --text-light: #8FA0B3;
  --border-color: #E8F4F8;
  --border-hover: #B8E6FF;
  --danger-color: #E74C3C;
  --success-color: #27AE60;
  --warning-color: #F39C12;
  --admin-bg: linear-gradient(135deg, #2C3E50 0%, #34495E 100%);
}

/* ---------- Base ---------- */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: var(--background-gradient);
  color: var(--text-primary);
  line-height: 1.7;
  min-height: 100vh;
  font-feature-settings: "palt";
}

/* ---------- Header ---------- */
.header {
  background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-accent) 100%);
  padding: 1rem 2rem;
  text-align: center;
  margin-bottom: 2rem;
  position: relative;
  overflow: hidden;
}

.header::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
  animation: headerGlow 6s ease-in-out infinite alternate;
}

@keyframes headerGlow {
  0% { transform: rotate(0deg) scale(1); }
  100% { transform: rotate(10deg) scale(1.1); }
}

.header h1 {
  color: #fff;
  font-size: 3.5rem;
  font-weight: 900;
  letter-spacing: -0.03em;
  margin-bottom: 0rem;
  position: relative;
  z-index: 1;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  animation: titleFloat 3s ease-in-out infinite alternate;
}

@keyframes titleFloat {
  0% { transform: translateY(0px); }
  100% { transform: translateY(-5px); }
}

.header p {
  color: rgba(255, 255, 255, 0.95);
  font-size: 1.3rem;
  font-weight: 400;
  letter-spacing: 0.02em;
  position: relative;
  z-index: 1;
  text-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
}

.admin-toggle {
  position: absolute;
  top: 1rem;
  right: 2rem;
  z-index: 10;
  background: rgba(255, 255, 255, 0.2);
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 12px;
  padding: 0.8rem 1.5rem;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.admin-toggle:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

/* ---------- Admin Panel ---------- */
.admin-panel {
  max-width: 1200px;
  margin: 0 auto 2rem;
  padding: 0 2rem;
}

.admin-container {
  background: var(--admin-bg);
  border-radius: 20px;
  padding: 2rem;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.admin-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid rgba(255, 255, 255, 0.1);
}

.admin-title {
  color: #fff;
  font-size: 1.8rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.admin-close {
  background: var(--danger-color);
  border: none;
  border-radius: 8px;
  padding: 0.5rem 1rem;
  color: #fff;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
}

.admin-close:hover {
  background: #C0392B;
  transform: translateY(-2px);
}

.admin-tabs {
  display: flex;
  gap: 1rem;
  margin-bottom: 2rem;
}

.admin-tab {
  padding: 0.8rem 1.5rem;
  background: rgba(255, 255, 255, 0.1);
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  color: rgba(255, 255, 255, 0.8);
  cursor: pointer;
  transition: all 0.3s ease;
  font-weight: 600;
}

.admin-tab.active {
  background: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.4);
  color: #fff;
}

.admin-tab:hover {
  background: rgba(255, 255, 255, 0.15);
}

.admin-content {
  color: #fff;
}

/* ---------- Login Form ---------- */
.login-form {
  max-width: 500px;
  margin: 0 auto;
  background: rgba(255, 255, 255, 0.1);
  padding: 2rem;
  border-radius: 16px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.login-form h3 {
  text-align: center;
  margin-bottom: 1.5rem;
  color: #fff;
  font-weight: 700;
}

.auth-status {
  margin-bottom: 1.5rem;
  padding: 1rem;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  text-align: center;
  font-weight: 600;
}

.form-group {
  margin-bottom: 1.5rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  color: rgba(255, 255, 255, 0.9);
  font-weight: 600;
}

.form-group input, .form-group select {
  width: 100%;
  padding: 0.8rem;
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  font-size: 1rem;
  transition: all 0.3s ease;
}

.form-group input:focus, .form-group select:focus {
  outline: none;
  border-color: var(--primary-accent);
  background: rgba(255, 255, 255, 0.15);
}

.form-group input::placeholder {
  color: rgba(255, 255, 255, 0.6);
}

.form-group select option {
  background: var(--text-primary);
  color: #fff;
}

.btn-primary {
  width: 100%;
  padding: 1rem;
  background: var(--primary-accent);
  border: none;
  border-radius: 8px;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 1rem;
}

.btn-primary:hover {
  background: var(--primary-dark);
  transform: translateY(-2px);
}

.btn-secondary {
  background: var(--success-color);
  border: none;
  border-radius: 6px;
  padding: 0.5rem 1rem;
  color: #fff;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-secondary:hover {
  background: #229954;
  transform: translateY(-1px);
}

.login-error {
  background: rgba(231, 76, 60, 0.2);
  border: 1px solid rgba(231, 76, 60, 0.5);
  color: #fff;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  text-align: center;
}

.user-registration {
  margin-top: 1.5rem;
  padding: 1rem;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.user-list {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
  padding: 1rem;
  margin-top: 1rem;
}

.user-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem;
  margin-bottom: 0.5rem;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 6px;
}

.user-name {
  color: #fff;
  font-weight: 600;
}

.btn-danger {
  background: var(--danger-color);
  border: none;
  border-radius: 4px;
  padding: 0.3rem 0.8rem;
  color: #fff;
  cursor: pointer;
  font-size: 0.8rem;
  font-weight: 600;
}

.btn-danger:hover {
  background: #C0392B;
}

/* ---------- Feed Management ---------- */
.feed-manager {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
}

.feed-list {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  padding: 1.5rem;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.feed-form {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  padding: 1.5rem;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.feed-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
  margin-bottom: 1rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.feed-info {
  flex: 1;
}

.feed-name {
  font-weight: 600;
  color: #fff;
  margin-bottom: 0.25rem;
}

.feed-url {
  font-size: 0.9rem;
  color: rgba(255, 255, 255, 0.7);
  word-break: break-all;
}

.feed-actions {
  display: flex;
  gap: 0.5rem;
}

.btn-small {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-edit {
  background: var(--warning-color);
  color: #fff;
}

.btn-edit:hover {
  background: #E67E22;
}

.btn-delete {
  background: var(--danger-color);
  color: #fff;
}

.btn-delete:hover {
  background: #C0392B;
}

/* ---------- Statistics ---------- */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;
}

.stat-card {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  padding: 1.5rem;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.stat-value {
  font-size: 2rem;
  font-weight: 700;
  color: #fff;
  margin-bottom: 0.5rem;
}

.stat-label {
  color: rgba(255, 255, 255, 0.8);
  font-size: 0.9rem;
}

.error-log {
  background: rgba(231, 76, 60, 0.1);
  border: 1px solid rgba(231, 76, 60, 0.3);
  border-radius: 12px;
  padding: 1.5rem;
  max-height: 300px;
  overflow-y: auto;
}

.error-item {
  padding: 0.8rem;
  background: rgba(231, 76, 60, 0.1);
  border-radius: 8px;
  margin-bottom: 1rem;
  border-left: 4px solid var(--danger-color);
}

.error-time {
  font-size: 0.8rem;
  color: rgba(255, 255, 255, 0.6);
  margin-bottom: 0.25rem;
}

.error-message {
  color: #fff;
  font-weight: 600;
}

/* ---------- Loading ---------- */
.loading {
  text-align: center;
  padding: 5rem;
  font-size: 1.2rem;
  color: var(--primary-accent);
  font-weight: 500;
}

.loading::after {
  content: '';
  display: inline-block;
  width: 24px;
  height: 24px;
  margin-left: 15px;
  border: 3px solid var(--primary-light);
  border-top: 3px solid var(--primary-accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* ---------- Error ---------- */
.error {
  background: linear-gradient(135deg, #FFF5F5 0%, #FFEBEE 100%);
  border: 2px solid #FFCDD2;
  border-radius: 16px;
  padding: 3rem;
  margin: 3rem auto;
  max-width: 600px;
  text-align: center;
  color: #C62828;
  box-shadow: 0 4px 20px rgba(198, 40, 40, 0.1);
}

/* ---------- Filter Tabs ---------- */
.feed-filters {
  max-width: 1200px;
  margin: 0 auto 4rem;
  padding: 0 2rem;
  display: flex;
  gap: 0.8rem;
  flex-wrap: nowrap;
  overflow-x: auto;
  white-space: nowrap;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: thin;
}

.feed-filters::-webkit-scrollbar {
  height: 8px;
}

.feed-filters::-webkit-scrollbar-track {
  background: var(--primary-light);
  border-radius: 4px;
}

.feed-filters::-webkit-scrollbar-thumb {
  background: var(--primary-accent);
  border-radius: 4px;
}

.filter-button {
  padding: 1rem 2rem;
  border: 2px solid var(--border-color);
  border-radius: 12px;
  background: linear-gradient(135deg, #fff 0%, #F8FDFF 100%);
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 0.95rem;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  letter-spacing: 0.01em;
  flex-shrink: 0;
  white-space: nowrap;
  min-width: fit-content;
  max-width: 140px;
  overflow: hidden;
  text-overflow: ellipsis;
  position: relative;
  box-shadow: 0 2px 8px rgba(91, 168, 196, 0.08);
}

.filter-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
  transition: left 0.5s;
}

.filter-button:hover::before {
  left: 100%;
}

.filter-button:hover {
  border-color: var(--border-hover);
  color: var(--primary-accent);
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(91, 168, 196, 0.15);
}

.filter-button.active {
  background: linear-gradient(135deg, var(--primary-accent) 0%, var(--primary-dark) 100%);
  border-color: var(--primary-accent);
  color: #fff;
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(91, 168, 196, 0.3);
}

/* ---------- Cards ---------- */
.cards-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 2rem;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1.5rem;
}

.article-card {
  background: linear-gradient(135deg, #fff 0%, #F8FDFF 100%);
  border: 2px solid var(--border-color);
  border-radius: 20px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  box-shadow: var(--card-shadow);
  backdrop-filter: blur(10px);
}

.article-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--primary-accent), var(--primary-dark));
  transform: scaleX(0);
  transition: transform 0.3s ease;
}

.article-card:hover::before {
  transform: scaleX(1);
}

.article-card:hover {
  border-color: var(--border-hover);
  transform: translateY(-6px) scale(1.02);
  box-shadow: var(--card-shadow-hover);
}

.source-badge {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  padding: 0.6rem 1.2rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 700;
  color: #fff;
  z-index: 2;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

/* --- Thumbnail Container --- */
.thumbnail-container {
  position: relative;
  width: 100%;
  height: 160px;
  overflow: hidden;
  background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-medium) 100%);
}

.thumbnail {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transition: all 0.4s ease;
  filter: brightness(1.05) contrast(1.05);
}

.thumbnail:hover {
  transform: scale(1.05);
  filter: brightness(1.1) contrast(1.1);
}

.thumbnail.error {
  display: none;
}

.thumbnail-placeholder {
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--primary-accent) 0%, var(--primary-dark) 100%);
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 3rem;
  color: #fff;
  animation: pulseGlow 2s ease-in-out infinite alternate;
}

@keyframes pulseGlow {
  0% { box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.1); }
  100% { box-shadow: inset 0 0 40px rgba(255, 255, 255, 0.2); }
}

.thumbnail-placeholder.show {
  display: flex;
}

/* --- Card Content --- */
.card-content {
  padding: 2.5rem;
}

.article-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 1.5rem;
  line-height: 1.4;
  letter-spacing: -0.02em;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.article-summary {
  color: var(--text-secondary);
  font-size: 1.05rem;
  line-height: 1.8;
  margin-bottom: 2rem;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  font-weight: 400;
}

.article-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: var(--text-light);
  font-size: 0.9rem;
  border-top: 2px solid var(--border-color);
  padding-top: 1.5rem;
  position: relative;
}

.article-meta::before {
  content: '';
  position: absolute;
  top: -2px;
  left: 0;
  width: 60px;
  height: 2px;
  background: linear-gradient(90deg, var(--primary-accent), var(--primary-dark));
}

.publish-date {
  font-weight: 600;
  color: var(--text-secondary);
}

/* ---------- Info ---------- */
.update-info {
  text-align: center;
  margin: 5rem auto 4rem;
  color: var(--text-light);
  font-size: 0.95rem;
  font-weight: 500;
  padding: 1.5rem;
  background: linear-gradient(135deg, rgba(224, 247, 255, 0.5) 0%, rgba(240, 251, 255, 0.5) 100%);
  border-radius: 12px;
  max-width: 400px;
  backdrop-filter: blur(10px);
  border: 1px solid var(--border-color);
}

/* ---------- Responsive ---------- */
@media (max-width: 1024px) {
  .cards-container {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .feed-manager {
    grid-template-columns: 1fr;
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .header {
    padding: 1rem 1rem;
  }
  
  .header h1 {
    font-size: 2.8rem;
  }
  
  .admin-toggle {
    position: relative;
    top: auto;
    right: auto;
    margin-top: 1rem;
  }
  
  .cards-container {
    grid-template-columns: 1fr;
    gap: 1.5rem;
    padding: 0 1rem;
  }
  
  .feed-filters {
    padding: 0 1rem;
    gap: 0.6rem;
  }
  
  .filter-button {
    padding: 0.8rem 1.5rem;
    font-size: 0.9rem;
  }
  
  .card-content {
    padding: 2rem;
  }
  
  .thumbnail-container {
    height: 140px;
  }
  
  .admin-tabs {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 480px) {
  .header h1 {
    font-size: 2.2rem;
  }
  
  .header p {
    font-size: 1.1rem;
  }
  
  .article-title {
    font-size: 1.3rem;
  }
  
  .filter-button {
    font-size: 0.85rem;
    padding: 0.7rem 1.2rem;
    max-width: 120px;
  }
  
  .source-badge {
    top: 1rem;
    right: 1rem;
    padding: 0.5rem 1rem;
  }
  
  .thumbnail-container {
    height: 120px;
  }
  
  .admin-panel {
    padding: 0 1rem;
  }
  
  .admin-container {
    padding: 1.5rem;
  }
}

/* ---------- Animations ---------- */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.article-card {
  animation: fadeInUp 0.6s ease-out;
}

.article-card:nth-child(even) {
  animation-delay: 0.1s;
}

.article-card:nth-child(3n) {
  animation-delay: 0.2s;
}

.admin-panel {
  animation: fadeInUp 0.4s ease-out;
}
</style>
</head>

<body>
<div id="app">
  <!-- Header -->
  <header class="header">
    <h1>ğŸ—‚ ãã‚…ãã‚…ã£ã¨NEWS</h1>
    <p>ã»ã—ã„æƒ…å ±ãã‚…ãã‚…ã£ã¨ãŠå±Šã‘</p>
    <button class="admin-toggle" @click="showAdminPanel = !showAdminPanel">
      {{ showAdminPanel ? 'ğŸ”’ ç®¡ç†çµ‚äº†' : 'âš™ï¸ ç®¡ç†ç”»é¢' }}
    </button>
  </header>

  <!-- Admin Panel -->
  <div v-if="showAdminPanel" class="admin-panel">
    <div class="admin-container">
      <!-- Login Form -->
      <div v-if="!isAuthenticated" class="login-form">
        <h3>ğŸ” ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</h3>
        
        <!-- WebAuthn Support Status -->
        <div class="auth-status">
          <div v-if="isWebAuthnSupported" style="color: #27AE60;">
            âœ… ç”Ÿä½“èªè¨¼å¯¾å¿œï¼ˆæŒ‡ç´‹ãƒ»é¡”èªè¨¼åˆ©ç”¨å¯èƒ½ï¼‰
          </div>
          <div v-else style="color: #F39C12;">
            âš ï¸ ç”Ÿä½“èªè¨¼éå¯¾å¿œï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ã‚’ä½¿ç”¨ï¼‰
          </div>
        </div>
        
        <div v-if="loginError" class="login-error">{{ loginError }}</div>
        
        <!-- User Selection -->
        <div v-if="registeredUsers.length > 0" class="form-group">
          <label>ãƒ¦ãƒ¼ã‚¶ãƒ¼é¸æŠ:</label>
          <select v-model="selectedUser">
            <option value="">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
            <option v-for="user in registeredUsers" :key="user" :value="user">{{ user }}</option>
          </select>
        </div>
        
        <!-- Authentication Button -->
        <button v-if="registeredUsers.length > 0" @click="authenticateUser" class="btn-primary" style="margin-bottom: 1rem;">
          {{ isWebAuthnSupported ? 'ğŸ”“ ç”Ÿä½“èªè¨¼ã§ãƒ­ã‚°ã‚¤ãƒ³' : 'ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼' }}
        </button>
        
        <!-- User Registration Toggle -->
        <div style="text-align: center; margin-top: 1rem;">
          <button @click="showUserRegistration = !showUserRegistration" class="btn-secondary">
            {{ showUserRegistration ? 'ç™»éŒ²ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«' : 'â• æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²' }}
          </button>
        </div>
        
        <!-- User Registration Form -->
        <div v-if="showUserRegistration" class="user-registration">
          <div class="form-group">
            <label>æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼å:</label>
            <input type="text" v-model="newUsername" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›">
          </div>
          <button @click="registerNewUser" class="btn-primary">
            {{ isWebAuthnSupported ? 'ğŸ‘† ç”Ÿä½“èªè¨¼ã§ç™»éŒ²' : 'ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ç™»éŒ²' }}
          </button>
        </div>
        
        <!-- First Time Setup -->
        <div v-if="registeredUsers.length === 0" style="text-align: center; padding: 2rem; color: rgba(255,255,255,0.8);">
          <p style="margin-bottom: 1rem;">åˆå›åˆ©ç”¨ã§ã™ã€‚ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚</p>
          <button @click="showUserRegistration = true" class="btn-primary">
            ğŸ¯ ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™»éŒ²
          </button>
        </div>
        
        <!-- Registered Users List -->
        <div v-if="registeredUsers.length > 0 && showUserRegistration" class="user-list">
          <h4 style="margin-bottom: 1rem; color: #fff;">ç™»éŒ²æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼</h4>
          <div v-for="user in registeredUsers" :key="user" class="user-item">
            <span class="user-name">{{ user }}</span>
            <button @click="removeUser(user)" class="btn-danger">å‰Šé™¤</button>
          </div>
        </div>
      </div>

      <!-- Authenticated Admin Panel -->
      <div v-else>
        <div class="admin-header">
          <h2 class="admin-title">âš™ï¸ ç®¡ç†ç”»é¢</h2>
          <button class="admin-close" @click="logout">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
        </div>

        <div class="admin-tabs">
          <button class="admin-tab" :class="{active: activeTab === 'feeds'}" 
                  @click="activeTab = 'feeds'">ğŸ“° ãƒ•ã‚£ãƒ¼ãƒ‰ç®¡ç†</button>
          <button class="admin-tab" :class="{active: activeTab === 'stats'}" 
                  @click="activeTab = 'stats'">ğŸ“Š çµ±è¨ˆæƒ…å ±</button>
          <button class="admin-tab" :class="{active: activeTab === 'users'}" 
                  @click="activeTab = 'users'">ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</button>
        </div>

        <div class="admin-content">
          <!-- Feed Management -->
          <div v-if="activeTab === 'feeds'" class="feed-manager">
            <div class="feed-list">
              <h3>ğŸ“„ ç™»éŒ²æ¸ˆã¿ãƒ•ã‚£ãƒ¼ãƒ‰</h3>
              <div v-if="feeds.length === 0" style="text-align: center; padding: 2rem; color: rgba(255,255,255,0.6);">
                ãƒ•ã‚£ãƒ¼ãƒ‰ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“
              </div>
              <div v-for="feed in feeds" :key="feed.name" class="feed-item">
                <div class="feed-info">
                  <div class="feed-name">{{ feed.name }}</div>
                  <div class="feed-url">{{ feed.url }}</div>
                </div>
                <div class="feed-actions">
                  <button class="btn-small btn-edit" @click="editFeed(feed)">ç·¨é›†</button>
                  <button class="btn-small btn-delete" @click="deleteFeed(feed)">å‰Šé™¤</button>
                </div>
              </div>
            </div>

            <div class="feed-form">
              <h3>{{ editingFeed ? 'ğŸ“ ãƒ•ã‚£ãƒ¼ãƒ‰ç·¨é›†' : 'â• ãƒ•ã‚£ãƒ¼ãƒ‰è¿½åŠ ' }}</h3>
              <form @submit.prevent="saveFeed">
                <div class="form-group">
                  <label>ãƒ•ã‚£ãƒ¼ãƒ‰å:</label>
                  <input type="text" v-model="feedForm.name" 
                         placeholder="ä¾‹: æŠ€è¡“ãƒ‹ãƒ¥ãƒ¼ã‚¹" required>
                </div>
                <div class="form-group">
                  <label>RSS URL:</label>
                  <input type="url" v-model="feedForm.url" 
                         placeholder="https://example.com/feed.xml" required>
                </div>
                <div class="form-group">
                  <label>è¡¨ç¤ºè‰²:</label>
                  <input type="color" v-model="feedForm.color" required>
                </div>
                <div style="display: flex; gap: 1rem;">
                  <button type="submit" class="btn-primary" style="flex: 1;">
                    {{ editingFeed ? 'æ›´æ–°' : 'è¿½åŠ ' }}
                  </button>
                  <button v-if="editingFeed" type="button" class="btn-primary" 
                          style="background: var(--text-light); flex: 1;" @click="cancelEdit">
                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                  </button>
                </div>
              </form>
            </div>
          </div>

          <!-- Statistics -->
          <div v-if="activeTab === 'stats'">
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value">{{ feeds.length }}</div>
                <div class="stat-label">ç™»éŒ²ãƒ•ã‚£ãƒ¼ãƒ‰æ•°</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">{{ entries.length }}</div>
                <div class="stat-label">è¨˜äº‹æ•°</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">{{ successRate }}%</div>
                <div class="stat-label">å–å¾—æˆåŠŸç‡</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">{{ failedFeeds }}</div>
                <div class="stat-label">ã‚¨ãƒ©ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰</div>
              </div>
            </div>

            <div class="error-log">
              <h3>ğŸš¨ ã‚¨ãƒ©ãƒ¼ãƒ­ã‚° (ç›´è¿‘24æ™‚é–“)</h3>
              <div v-if="errorLogs.length === 0" style="text-align: center; padding: 2rem; color: rgba(255,255,255,0.6);">
                ã‚¨ãƒ©ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“
              </div>
              <div v-for="error in errorLogs" :key="error.id" class="error-item">
                <div class="error-time">{{ formatDate(error.timestamp) }}</div>
                <div class="error-message">{{ error.message }}</div>
              </div>
            </div>
          </div>

          <!-- User Management -->
          <div v-if="activeTab === 'users'">
            <div class="user-list">
              <h3>ğŸ‘¥ ç™»éŒ²æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼</h3>
              <div v-for="user in registeredUsers" :key="user" class="user-item">
                <span class="user-name">{{ user }}</span>
                <button @click="removeUser(user)" class="btn-danger">å‰Šé™¤</button>
              </div>
            </div>
            
            <div class="user-registration" style="margin-top: 2rem;">
              <h3>â• æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼è¿½åŠ </h3>
              <div class="form-group">
                <label>ãƒ¦ãƒ¼ã‚¶ãƒ¼å:</label>
                <input type="text" v-model="newUsername" placeholder="æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
              </div>
              <button @click="registerNewUser" class="btn-primary">
                {{ isWebAuthnSupported ? 'ğŸ‘† ç”Ÿä½“èªè¨¼ã§ç™»éŒ²' : 'ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ç™»éŒ²' }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div v-if="loading" class="loading">ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿ä¸­</div>

  <!-- Error -->
  <div v-if="error" class="error">
    <h3>âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h3>
    <p>{{ error }}</p>
    <button @click="fetchFeeds" style="margin-top:1.5rem;padding:1rem 2rem;background:linear-gradient(135deg, var(--primary-accent) 0%, var(--primary-dark) 100%);color:#fff;border:none;border-radius:12px;font-weight:600;cursor:pointer;transition:all 0.3s;box-shadow:0 4px 15px rgba(91, 168, 196, 0.3)">
      ğŸ”„ å†èª­ã¿è¾¼ã¿
    </button>
  </div>

  <!-- Filters -->
  <div v-if="!loading && !error && feeds.length" class="feed-filters">
    <button class="filter-button" :class="{active:activeFilter==='all'}"
      @click="setFilter('all')" :title="'ã™ã¹ã¦('+filteredEntries.length+')'">
      {{ truncateText('ğŸ“° ã™ã¹ã¦ ('+filteredEntries.length+')') }}
    </button>
    <button v-for="feed in feeds" :key="feed.name" class="filter-button"
      :class="{active:activeFilter===feed.name.toLowerCase()}"
      :style="{background:activeFilter===feed.name.toLowerCase()?'linear-gradient(135deg, '+feed.color+' 0%, var(--primary-dark) 100%)':'linear-gradient(135deg, #fff 0%, #F8FDFF 100%)',
               color:activeFilter===feed.name.toLowerCase()?'white':'var(--text-secondary)',
               borderColor:activeFilter===feed.name.toLowerCase()?feed.color:'var(--border-color)'}"
      @click="setFilter(feed.name.toLowerCase())"
      :title="feed.name+' ('+getFilteredCount(feed.name.toLowerCase())+')'">
      {{ truncateText('ğŸ“„ '+feed.name+' ('+getFilteredCount(feed.name.toLowerCase())+')') }}
    </button>
  </div>

  <!-- Articles -->
  <div v-if="!loading && !error" class="cards-container">
    <article v-for="article in filteredEntries" :key="article.link" class="article-card" @click="openArticle(article.link)">
      <div class="source-badge" :style="{background:'linear-gradient(135deg, '+article.sourceColor+' 0%, var(--primary-dark) 100%)'}">
        {{ article.source }}
      </div>

      <div class="thumbnail-container">
        <img v-if="article.thumbnail" :src="article.thumbnail" :alt="article.title"
             class="thumbnail" @error="handleImageError($event,article)" @load="handleImageLoad" />
        <div :class="['thumbnail-placeholder',{'show':!article.thumbnail || article.thumbnailError}]">ğŸ“°</div>
      </div>

      <div class="card-content">
        <h2 class="article-title">{{ article.title }}</h2>
        <p class="article-summary">{{ article.summary }}</p>
        <div class="article-meta">
          <span class="publish-date">ğŸ• {{ formatDate(article.published) }}</span>
          <span>ğŸ“ {{ article.source }}</span>
        </div>
      </div>
    </article>
  </div>

  <div v-if="!loading && !error && lastUpdated" class="update-info">
    ğŸ”„ æœ€çµ‚æ›´æ–°: {{ formatDate(lastUpdated) }}
  </div>
</div>

<script>
// WebAuthn + Web Crypto API Authentication System
class ModernAuthSystem {
  constructor() {
    this.isWebAuthnSupported = window.PublicKeyCredential !== undefined;
    this.credentials = new Map();
    this.loadCredentials();
  }
  
  async register(username) {
    if (this.isWebAuthnSupported) {
      return await this.webAuthnRegister(username);
    } else {
      return await this.fallbackRegister(username);
    }
  }
  
  async authenticate(username) {
    if (this.isWebAuthnSupported) {
      return await this.webAuthnAuthenticate(username);
    } else {
      return await this.fallbackAuthenticate(username);
    }
  }
  
  async webAuthnRegister(username) {
    try {
      const challenge = crypto.getRandomValues(new Uint8Array(32));
      const userId = new TextEncoder().encode(username);
      
      const credential = await navigator.credentials.create({
        publicKey: {
          challenge: challenge,
          rp: {
            name: "ãã‚…ãã‚…ã£ã¨NEWS",
            id: window.location.hostname
          },
          user: {
            id: userId,
            name: username,
            displayName: `${username} (ãã‚…ãã‚…ã£ã¨NEWS)`
          },
          pubKeyCredParams: [
            { alg: -7, type: "public-key" },  // ES256
            { alg: -257, type: "public-key" } // RS256
          ],
          timeout: 60000,
          attestation: 'none',
          authenticatorSelection: {
            authenticatorAttachment: 'platform',
            userVerification: 'preferred'
          }
        }
      });
      
      const credentialData = {
        id: credential.id,
        rawId: Array.from(new Uint8Array(credential.rawId)),
        type: credential.type,
        username: username,
        method: 'webauthn',
        created: new Date().toISOString()
      };
      
      this.credentials.set(username, credentialData);
      this.saveCredentials();
      
      return { success: true, method: 'webauthn' };
    } catch (error) {
      console.error('WebAuthnç™»éŒ²ã‚¨ãƒ©ãƒ¼:', error);
      return { success: false, error: error.message };
    }
  }
  
  async webAuthnAuthenticate(username) {
    try {
      const storedCredential = this.credentials.get(username);
      if (!storedCredential) {
        throw new Error('ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“');
      }
      
      const challenge = crypto.getRandomValues(new Uint8Array(32));
      
      const assertion = await navigator.credentials.get({
        publicKey: {
          challenge: challenge,
          allowCredentials: [{
            id: new Uint8Array(storedCredential.rawId),
            type: 'public-key'
          }],
          timeout: 60000,
          userVerification: 'preferred'
        }
      });
      
      return { success: true, method: 'webauthn', username: username };
    } catch (error) {
      console.error('WebAuthnèªè¨¼ã‚¨ãƒ©ãƒ¼:', error);
      return { success: false, error: error.message };
    }
  }
  
  async fallbackRegister(username) {
    const password = prompt(`${username}ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¦ãã ã•ã„:`);
    if (!password) return { success: false, error: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“' };
    
    const hashedPassword = await this.createSecureHash(password);
    const credentialData = {
      username: username,
      password: hashedPassword,
      method: 'password',
      created: new Date().toISOString()
    };
    
    this.credentials.set(username, credentialData);
    this.saveCredentials();
    
    return { success: true, method: 'password' };
  }
  
  async fallbackAuthenticate(username) {
    const storedCredential = this.credentials.get(username);
    if (!storedCredential) {
      return { success: false, error: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“' };
    }
    
    const password = prompt(`${username}ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:`);
    if (!password) return { success: false, error: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“' };
    
    const hashedPassword = await this.createSecureHash(password);
    if (hashedPassword === storedCredential.password) {
      return { success: true, method: 'password', username: username };
    } else {
      return { success: false, error: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™' };
    }
  }
  
  async createSecureHash(password) {
    const encoder = new TextEncoder();
    const salt = 'gyugyu_news_secure_salt_2025';
    const data = encoder.encode(password + salt);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
  }
  
  saveCredentials() {
    const credentialsObj = Object.fromEntries(this.credentials);
    localStorage.setItem('webauthn_credentials', JSON.stringify(credentialsObj));
  }
  
  loadCredentials() {
    try {
      const stored = localStorage.getItem('webauthn_credentials');
      if (stored) {
        const credentialsObj = JSON.parse(stored);
        this.credentials = new Map(Object.entries(credentialsObj));
      }
    } catch (error) {
      console.error('èªè¨¼æƒ…å ±èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
      this.credentials = new Map();
    }
  }
  
  getRegisteredUsers() {
    return Array.from(this.credentials.keys());
  }
  
  removeUser(username) {
    this.credentials.delete(username);
    this.saveCredentials();
  }
}

// Vue.js Application
const { createApp } = Vue;
createApp({
  data() {
    return {
      // Core data
      loading: true,
      error: null,
      feeds: [],
      entries: [],
      activeFilter: 'all',
      lastUpdated: null,
      
      // Admin panel
      showAdminPanel: false,
      isAuthenticated: false,
      activeTab: 'feeds',
      loginError: null,
      feedForm: {
        name: '',
        url: '',
        color: '#5BA8C4'
      },
      editingFeed: null,
      
      // Statistics
      errorLogs: [],
      successRate: 0,
      failedFeeds: 0,
      
      // WebAuthn Authentication
      authSystem: null,
      registeredUsers: [],
      selectedUser: '',
      showUserRegistration: false,
      newUsername: '',
      
      // Security settings
      loginAttempts: 0,
      lastLoginAttempt: null,
      maxLoginAttempts: 8,
      lockoutTime: 3 * 60 * 1000,
      lockedUntil: null,
      
      // GitHub API
      githubToken: null,
      repoOwner: null,
      repoName: null
    }
  },
  
  computed: {
    filteredEntries() {
      return this.activeFilter === 'all' 
        ? this.entries 
        : this.entries.filter(e => e.sourceFeed === this.activeFilter)
    },
    
    isWebAuthnSupported() {
      return window.PublicKeyCredential !== undefined;
    }
  },
  
  methods: {
    // Feed management
    async fetchFeeds() {
      this.loading = true;
      this.error = null;
      
      try {
        const res = await fetch('./feeds.json');
        if (!res.ok) throw new Error('HTTP ' + res.status);
        
        const data = await res.json();
        this.feeds = data.feeds || [];
        this.entries = data.entries || [];
        this.lastUpdated = data.updated;
        
        this.entries = this.entries.map(e => ({
          ...e,
          summary: this.extractSummary(e.description || e.summary || ''),
          thumbnail: this.extractThumbnail(e),
          thumbnailError: false
        }));
        
        this.updateStatistics();
        console.log('âœ…', this.entries.length, 'ä»¶ã®è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
        
      } catch (err) {
        console.error('å–å¾—ã‚¨ãƒ©ãƒ¼', err);
        this.error = 'ãƒ•ã‚£ãƒ¼ãƒ‰å–å¾—å¤±æ•—: ' + err.message;
        this.logError('ãƒ•ã‚£ãƒ¼ãƒ‰å–å¾—å¤±æ•—', err.message);
      } finally {
        this.loading = false;
      }
    },
    
    extractSummary(html) {
      const text = html.replace(/<[^>]*>/g, '').trim();
      return text.length > 150 ? text.slice(0, 150) + 'â€¦' : text;
    },
    
    extractThumbnail(entry) {
      let url = null;
      
      if (entry.thumbnail) {
        url = typeof entry.thumbnail === 'string' ? entry.thumbnail : entry.thumbnail.url;
      }
      
      if (!url && entry.enclosures?.length) {
        const enc = entry.enclosures.find(e => e.type?.startsWith('image/') && (e.url || e.href));
        if (enc) url = enc.url || enc.href;
      }
      
      if (!url && entry['media:content']) {
        const arr = Array.isArray(entry['media:content']) ? entry['media:content'] : [entry['media:content']];
        for (const m of arr) {
          if (m.url && (m.medium === 'image' || m.type?.startsWith('image/'))) {
            url = m.url;
            break;
          }
        }
      }
      
      if (!url && entry['media:thumbnail']) {
        url = typeof entry['media:thumbnail'] === 'string' ? entry['media:thumbnail'] : entry['media:thumbnail'].url;
      }
      
      if (!url && entry.description) {
        const match = entry.description.match(/<img[^>]+src=["']([^"']+)["']/i);
        if (match) url = match[1];
      }
      
      if (!url && entry.content) {
        const content = typeof entry.content === 'object' ? (entry.content.value || entry.content['#text'] || '') : entry.content;
        const match = content.match(/<img[^>]+src=["']([^"']+)["']/i);
        if (match) url = match[1];
      }
      
      if (url) {
        try {
          const urlObj = new URL(url);
          if (urlObj.protocol !== 'https:') return null;
          
          const ngPatterns = ['ogp.png', '/admin/', '/private/', '/protected/', 'basic-auth', 'unauthorized'];
          if (ngPatterns.some(pattern => url.toLowerCase().includes(pattern))) {
            return null;
          }
          
          return url;
        } catch (e) {
          return null;
        }
      }
      
      return null;
    },
    
    handleImageError(event, article) {
      console.warn('ç”»åƒèª­ã¿è¾¼ã¿å¤±æ•—', event.target.src);
      article.thumbnailError = true;
      event.target.classList.add('error');
      event.target.parentElement.querySelector('.thumbnail-placeholder')?.classList.add('show');
    },
    
    handleImageLoad(event) {
      event.target.style.opacity = '1';
    },
    
    truncateText(text, maxLength = 12) {
      return text.length <= maxLength ? text : text.slice(0, maxLength) + 'â€¦';
    },
    
    setFilter(filter) {
      this.activeFilter = filter;
    },
    
    getFilteredCount(sourceFeed) {
      return this.entries.filter(e => e.sourceFeed === sourceFeed).length;
    },
    
    openArticle(url) {
      window.open(url, '_blank');
    },
    
    formatDate(date) {
      if (!date) return '';
      const dt = new Date(date);
      return dt.toLocaleDateString('ja-JP') + ' ' + dt.toLocaleTimeString('ja-JP', {
        hour: '2-digit',
        minute: '2-digit'
      });
    },
    
    // Authentication
    async initializeAuth() {
      this.authSystem = new ModernAuthSystem();
      this.registeredUsers = this.authSystem.getRegisteredUsers();
    },
    
    async registerNewUser() {
      if (!this.newUsername.trim()) {
        this.loginError = 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
        return;
      }
      
      if (this.registeredUsers.includes(this.newUsername)) {
        this.loginError = 'ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™';
        return;
      }
      
      try {
        const result = await this.authSystem.register(this.newUsername);
        
        if (result.success) {
          this.registeredUsers = this.authSystem.getRegisteredUsers();
          const username = this.newUsername;
          this.newUsername = '';
          this.showUserRegistration = false;
          this.loginError = null;
          
          alert(`âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ${username}ã€ã‚’ç™»éŒ²ã—ã¾ã—ãŸï¼ˆ${result.method}ï¼‰`);
        } else {
          this.loginError = `ç™»éŒ²å¤±æ•—: ${result.error}`;
        }
      } catch (error) {
        this.loginError = `ç™»éŒ²ã‚¨ãƒ©ãƒ¼: ${error.message}`;
      }
    },
    
    async authenticateUser() {
      if (!this.selectedUser) {
        this.loginError = 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’é¸æŠã—ã¦ãã ã•ã„';
        return;
      }
      
      if (this.isAccountLocked()) {
        const remainingTime = Math.ceil((this.lockedUntil - Date.now()) / 1000 / 60);
        this.loginError = `ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ã€‚${remainingTime}åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚`;
        return;
      }
      
      const now = Date.now();
      if (this.lastLoginAttempt && now - this.lastLoginAttempt < 5000) {
        this.loginAttempts++;
        if (this.loginAttempts >= this.maxLoginAttempts) {
          this.lockedUntil = now + this.lockoutTime;
          this.loginError = 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸã€‚3åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚';
          this.logSecurityEvent('account_locked', {
            username: this.selectedUser,
            attempts: this.loginAttempts
          });
          return;
        }
      } else {
        this.loginAttempts = 1;
      }
      
      this.lastLoginAttempt = now;
      
      try {
        const result = await this.authSystem.authenticate(this.selectedUser);
        
        if (result.success) {
          this.isAuthenticated = true;
          this.selectedUser = '';
          this.loginError = null;
          this.loginAttempts = 0;
          this.lockedUntil = null;
          
          this.logSecurityEvent('login_success', {
            username: result.username,
            method: result.method
          });
          
          console.log(`âœ… èªè¨¼æˆåŠŸ: ${result.username} (${result.method})`);
        } else {
          this.loginError = `èªè¨¼å¤±æ•—: ${result.error}`;
          this.logSecurityEvent('login_failure', {
            username: this.selectedUser,
            error: result.error,
            attempts: this.loginAttempts
          });
        }
      } catch (error) {
        this.loginError = `èªè¨¼ã‚¨ãƒ©ãƒ¼: ${error.message}`;
        this.logSecurityEvent('login_error', {
          username: this.selectedUser,
          error: error.message
        });
      }
    },
    
    logout() {
      this.isAuthenticated = false;
      this.showAdminPanel = false;
      this.selectedUser = '';
      this.loginError = null;
    },
    
    removeUser(username) {
      if (confirm(`ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ${username}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        this.authSystem.removeUser(username);
        this.registeredUsers = this.authSystem.getRegisteredUsers();
        console.log(`âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤: ${username}`);
      }
    },
    
    isAccountLocked() {
      return this.lockedUntil && Date.now() < this.lockedUntil;
    },
    
    // Feed management
    editFeed(feed) {
      this.editingFeed = { ...feed };
      this.feedForm = { ...feed };
    },
    
    cancelEdit() {
      this.editingFeed = null;
      this.feedForm = {
        name: '',
        url: '',
        color: '#5BA8C4'
      };
    },
    
    async saveFeed() {
      try {
        if (this.editingFeed) {
          const index = this.feeds.findIndex(f => f.name === this.editingFeed.name);
          if (index !== -1) {
            this.feeds[index] = { ...this.feedForm };
          }
        } else {
          this.feeds.push({ ...this.feedForm });
        }
        
        await this.triggerGitHubActions('feed_updated', {
          action: this.editingFeed ? 'update' : 'add',
          feed: this.feedForm
        });
        
        this.cancelEdit();
        console.log('âœ… ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        
      } catch (err) {
        console.error('ãƒ•ã‚£ãƒ¼ãƒ‰ä¿å­˜ã‚¨ãƒ©ãƒ¼:', err);
        this.logError('ãƒ•ã‚£ãƒ¼ãƒ‰ä¿å­˜å¤±æ•—', err.message);
      }
    },
    
    async deleteFeed(feed) {
      if (!confirm(`ã€Œ${feed.name}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) return;
      
      try {
        this.feeds = this.feeds.filter(f => f.name !== feed.name);
        
        await this.triggerGitHubActions('feed_deleted', {
          action: 'delete',
          feed: feed
        });
        
        console.log('âœ… ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
        
      } catch (err) {
        console.error('ãƒ•ã‚£ãƒ¼ãƒ‰å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', err);
        this.logError('ãƒ•ã‚£ãƒ¼ãƒ‰å‰Šé™¤å¤±æ•—', err.message);
      }
    },
    
    // GitHub Actions
    async triggerGitHubActions(eventType, payload) {
      if (!this.githubToken || !this.repoOwner || !this.repoName) {
        console.warn('GitHub APIè¨­å®šãŒä¸å®Œå…¨ã§ã™');
        return;
      }
      
      const url = `https://api.github.com/repos/${this.repoOwner}/${this.repoName}/dispatches`;
      
      const response = await fetch(url, {
        method: 'POST',
        headers: {
          'Authorization': `token ${this.githubToken}`,
          'Accept': 'application/vnd.github.v3+json',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          event_type: eventType,
          client_payload: payload
        })
      });
      
      if (!response.ok) {
        throw new Error(`GitHub API Error: ${response.status}`);
      }
      
      console.log('âœ… GitHub Actions ãƒˆãƒªã‚¬ãƒ¼æˆåŠŸ');
    },
    
    // Statistics and monitoring
    updateStatistics() {
      const total = this.feeds.length;
      const failed = this.feeds.filter(f => f.status === 'error').length;
      this.failedFeeds = failed;
      this.successRate = total > 0 ? Math.round(((total - failed) / total) * 100) : 0;
    },
    
    logError(type, message) {
      const error = {
        id: Date.now(),
        timestamp: new Date().toISOString(),
        type: type,
        message: message
      };
      
      this.errorLogs.unshift(error);
      
      const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
      this.errorLogs = this.errorLogs.filter(log => new Date(log.timestamp) > oneDayAgo);
      
      localStorage.setItem('error_logs', JSON.stringify(this.errorLogs));
    },
    
    loadErrorLogs() {
      try {
        const logs = localStorage.getItem('error_logs');
        if (logs) {
          this.errorLogs = JSON.parse(logs);
          const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
          this.errorLogs = this.errorLogs.filter(log => new Date(log.timestamp) > oneDayAgo);
        }
      } catch (err) {
        console.error('ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°èª­ã¿è¾¼ã¿å¤±æ•—:', err);
      }
    },
    
    logSecurityEvent(eventType, details) {
      const event = {
        id: Date.now(),
        timestamp: new Date().toISOString(),
        type: eventType,
        details: details,
        userAgent: navigator.userAgent
      };
      
      const existingLogs = JSON.parse(localStorage.getItem('security_logs') || '[]');
      existingLogs.unshift(event);
      
      if (existingLogs.length > 100) {
        existingLogs.splice(100);
      }
      
      localStorage.setItem('security_logs', JSON.stringify(existingLogs));
      
      if (['account_locked', 'login_error'].includes(eventType)) {
        console.warn('ğŸš¨ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ©ãƒ¼ãƒˆ:', eventType, details);
      }
    },
    
    loadConfig() {
      this.githubToken = localStorage.getItem('github_token');
      this.repoOwner = localStorage.getItem('repo_owner');
      this.repoName = localStorage.getItem('repo_name');
    }
  },
  
  async mounted() {
    await this.initializeAuth();
    this.loadErrorLogs();
    this.loadConfig();
    this.fetchFeeds();
    
    setInterval(() => this.fetchFeeds(), 30 * 60 * 1000);
  }
}).mount('#app');
</script>
</body>
</html>
