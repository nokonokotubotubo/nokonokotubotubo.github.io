<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„ÇÆ„É•„ÇÆ„É•„ÉÉ„Å®NEWS</title>
    
    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <style>
        /* CSS Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafb;
            color: #1a202c;
            line-height: 1.7;
            min-height: 100vh;
            font-weight: 400;
        }
        
        /* Header Styles - „É¢„ÉÄ„É≥„Éï„É©„ÉÉ„Éà„Éá„Ç∂„Ç§„É≥ */
        .header {
            background: #4a90a4;
            padding: 4rem 2rem;
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
        }
        
        .header h1 {
            color: white;
            font-size: 3rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            color: rgba(255,255,255,0.9);
            font-size: 1.2rem;
            font-weight: 500;
            position: relative;
            z-index: 1;
            letter-spacing: 0.01em;
        }
        
        /* Loading Styles */
        .loading {
            text-align: center;
            padding: 4rem;
            font-size: 1.1rem;
            color: #4a90a4;
            font-weight: 500;
        }
        
        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-left: 12px;
            border: 2px solid #e2e8f0;
            border-top: 2px solid #4a90a4;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Error Styles */
        .error {
            background: #fff5f5;
            border: 1px solid #fed7d7;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem auto;
            max-width: 600px;
            text-align: center;
            color: #c53030;
        }
        
        /* Feed Filter Styles - Áµ±‰∏ÄÊÑüÈáçË¶ñ */
        .feed-filters {
            max-width: 1200px;
            margin: 0 auto 3rem;
            padding: 0 2rem;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .filter-button {
            padding: 0.75rem 1.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            color: #4a5568;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s ease;
            letter-spacing: 0.01em;
        }
        
        .filter-button:hover {
            border-color: #4a90a4;
            color: #4a90a4;
        }
        
        .filter-button.active {
            background: #4a90a4;
            border-color: #4a90a4;
            color: white;
        }
        
        /* Cards Container - „Ç∞„É™„ÉÉ„ÉâÊúÄÈÅ©Âåñ */
        .cards-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 2rem;
        }
        
        /* Card Styles - „Éï„É©„ÉÉ„Éà„Éá„Ç∂„Ç§„É≥ */
        .article-card {
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            overflow: hidden;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
        }
        
        .article-card:hover {
            border-color: #4a90a4;
            transform: translateY(-2px);
        }
        
        /* Source Badge - „Éï„É©„ÉÉ„Éà„Çπ„Çø„Ç§„É´ */
        .source-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            z-index: 2;
            letter-spacing: 0.02em;
        }
        
        /* Thumbnail Styles */
        .thumbnail {
            width: 100%;
            height: 220px;
            object-fit: cover;
            background: #f7fafc;
        }
        
        .thumbnail-placeholder {
            width: 100%;
            height: 220px;
            background: #4a90a4;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: white;
        }
        
        /* Card Content - „Çø„Ç§„Éù„Ç∞„É©„Éï„Ç£ÊîπËâØ */
        .card-content {
            padding: 2rem;
        }
        
        .article-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 1rem;
            line-height: 1.5;
            letter-spacing: -0.01em;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .article-summary {
            color: #4a5568;
            font-size: 1rem;
            line-height: 1.7;
            margin-bottom: 1.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .article-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #718096;
            font-size: 0.9rem;
            border-top: 1px solid #f7fafc;
            padding-top: 1rem;
        }
        
        .publish-date {
            font-weight: 600;
        }
        
        /* Update Info */
        .update-info {
            text-align: center;
            margin: 4rem auto 3rem;
            color: #718096;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        /* Responsive Design - „Éê„É©„É≥„ÇπÈáçË¶ñ */
        @media (max-width: 768px) {
            .header {
                padding: 3rem 1rem;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .cards-container {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                padding: 0 1rem;
            }
            
            .feed-filters {
                padding: 0 1rem;
                gap: 0.5rem;
            }
            
            .filter-button {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }
            
            .card-content {
                padding: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .article-title {
                font-size: 1.2rem;
            }
            
            .filter-button {
                font-size: 0.85rem;
                padding: 0.5rem 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Êó¢Â≠ò„ÅÆHTMLÊßãÈÄ†„ÅØÂ§âÊõ¥„Å™„Åó -->
    <div id="app">
        <!-- Header Section -->
        <header class="header">
            <h1>üì∞ „ÇÆ„É•„ÇÆ„É•„ÉÉ„Å®NEWS</h1>
            <p>„Åª„Åó„ÅÑÊÉÖÂ†±„ÇÆ„É•„ÇÆ„É•„ÉÉ„Å®„ÅäÂ±ä„Åë</p>
        </header>
        
        <!-- Loading State -->
        <div v-if="loading" class="loading">
            „Éï„Ç£„Éº„Éâ„ÇíË™≠„ÅøËæº„Åø‰∏≠
        </div>
        
        <!-- Error State -->
        <div v-if="error" class="error">
            <h3>‚ùå „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü</h3>
            <p>{{ error }}</p>
            <button @click="fetchFeeds" style="margin-top: 1rem; padding: 0.75rem 1.5rem; background: #4a90a4; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                ÂÜçË™≠„ÅøËæº„Åø
            </button>
        </div>
        
        <!-- Feed Filters -->
        <div v-if="!loading && !error && feeds.length > 0" class="feed-filters">
            <button 
                class="filter-button" 
                :class="{ active: activeFilter === 'all' }"
                @click="setFilter('all')"
            >
                „Åô„Åπ„Å¶ ({{ filteredEntries.length }})
            </button>
            <button 
                v-for="feed in feeds" 
                :key="feed.name"
                class="filter-button" 
                :class="{ active: activeFilter === feed.name.toLowerCase() }"
                :style="{ backgroundColor: activeFilter === feed.name.toLowerCase() ? feed.color : 'white', color: activeFilter === feed.name.toLowerCase() ? 'white' : '#4a5568', borderColor: activeFilter === feed.name.toLowerCase() ? feed.color : '#e2e8f0' }"
                @click="setFilter(feed.name.toLowerCase())"
            >
                {{ feed.name }} ({{ getFilteredCount(feed.name.toLowerCase()) }})
            </button>
        </div>
        
        <!-- Articles Grid -->
        <div v-if="!loading && !error" class="cards-container">
            <article 
                v-for="article in filteredEntries" 
                :key="article.link"
                class="article-card"
                @click="openArticle(article.link)"
            >
                <!-- Source Badge -->
                <div class="source-badge" :style="{ backgroundColor: article.sourceColor }">
                    {{ article.source }}
                </div>
                
                <!-- Thumbnail -->
                <img 
                    v-if="article.thumbnail" 
                    :src="article.thumbnail" 
                    :alt="article.title"
                    class="thumbnail"
                    @error="handleImageError"
                />
                <div v-else class="thumbnail-placeholder">
                    üì∞
                </div>
                
                <!-- Content -->
                <div class="card-content">
                    <h2 class="article-title">{{ article.title }}</h2>
                    <p class="article-summary">{{ article.summary }}</p>
                    <div class="article-meta">
                        <span class="publish-date">{{ formatDate(article.published) }}</span>
                        <span>{{ article.source }}</span>
                    </div>
                </div>
            </article>
        </div>
        
        <!-- Update Info -->
        <div v-if="!loading && !error && lastUpdated" class="update-info">
            ÊúÄÁµÇÊõ¥Êñ∞: {{ formatDate(lastUpdated) }}
        </div>
    </div>

    <!-- Êó¢Â≠ò„ÅÆJavaScript„ÅØÂ§âÊõ¥„Å™„Åó -->
    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    loading: true,
                    error: null,
                    feeds: [],
                    entries: [],
                    activeFilter: 'all',
                    lastUpdated: null
                }
            },
            computed: {
                filteredEntries() {
                    if (this.activeFilter === 'all') {
                        return this.entries;
                    }
                    return this.entries.filter(entry => 
                        entry.sourceFeed === this.activeFilter
                    );
                }
            },
            methods: {
                async fetchFeeds() {
                    this.loading = true;
                    this.error = null;
                    
                    try {
                        const response = await fetch('./feeds.json');
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        const data = await response.json();
                        
                        this.feeds = data.feeds || [];
                        this.entries = data.entries || [];
                        this.lastUpdated = data.updated;
                        
                        // „Éá„Éº„ÇøÂâçÂá¶ÁêÜ
                        this.entries = this.entries.map(entry => ({
                            ...entry,
                            summary: this.extractSummary(entry.description || ''),
                            thumbnail: this.extractThumbnail(entry)
                        }));
                        
                        console.log(`‚úÖ ${this.entries.length}‰ª∂„ÅÆË®ò‰∫ã„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü`);
                        
                    } catch (error) {
                        console.error('„Éï„Ç£„Éº„ÉâÂèñÂæó„Ç®„É©„Éº:', error);
                        this.error = `„Éï„Ç£„Éº„Éâ„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`;
                    } finally {
                        this.loading = false;
                    }
                },
                
                extractSummary(htmlContent) {
                    // HTML„Çø„Ç∞„ÇíÈô§Âéª„Åó„Å¶„Éó„É¨„Éº„É≥„ÉÜ„Ç≠„Çπ„Éà„Å´
                    const text = htmlContent.replace(/<[^>]*>/g, '').trim();
                    // 150ÊñáÂ≠ó„Åß„Ç´„ÉÉ„Éà
                    return text.length > 150 ? text.substring(0, 150) + '...' : text;
                },
                
                extractThumbnail(entry) {
                    // RSSÂÜÖ„ÅÆÁîªÂÉèÊÉÖÂ†±„ÇíÊäΩÂá∫Ôºàenclosure„ÄÅmedia:contentÁ≠âÔºâ
                    if (entry.enclosures && entry.enclosures.length > 0) {
                        const imageEnclosure = entry.enclosures.find(enc => 
                            enc.type && enc.type.startsWith('image/')
                        );
                        if (imageEnclosure) return imageEnclosure.url;
                    }
                    
                    // media:content „Åã„ÇâÁîªÂÉèÊäΩÂá∫
                    if (entry['media:content']) {
                        return entry['media:content'].url;
                    }
                    
                    // descriptionÂÜÖ„ÅÆimgË¶ÅÁ¥†„Åã„ÇâÊäΩÂá∫„ÇíË©¶Ë°å
                    if (entry.description) {
                        const imgMatch = entry.description.match(/<img[^>]+src="([^"]+)"/);
                        if (imgMatch) return imgMatch[1];
                    }
                    
                    return null;
                },
                
                setFilter(filter) {
                    this.activeFilter = filter;
                },
                
                getFilteredCount(sourceFeed) {
                    return this.entries.filter(entry => 
                        entry.sourceFeed === sourceFeed
                    ).length;
                },
                
                openArticle(url) {
                    window.open(url, '_blank');
                },
                
                formatDate(dateString) {
                    if (!dateString) return '';
                    const date = new Date(dateString);
                    return date.toLocaleDateString('ja-JP') + ' ' + 
                           date.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
                },
                
                handleImageError(event) {
                    // ÁîªÂÉèË™≠„ÅøËæº„Åø„Ç®„É©„ÉºÊôÇ„ÅÆÂá¶ÁêÜ
                    event.target.style.display = 'none';
                    const placeholder = event.target.nextElementSibling;
                    if (placeholder && placeholder.classList.contains('thumbnail-placeholder')) {
                        placeholder.style.display = 'flex';
                    }
                }
            },
            
            mounted() {
                this.fetchFeeds();
                
                // 30ÂàÜ„Åî„Å®„Å´Ëá™ÂãïÊõ¥Êñ∞
                setInterval(() => {
                    this.fetchFeeds();
                }, 30 * 60 * 1000);
            }
        }).mount('#app');
    </script>
</body>
</html>
