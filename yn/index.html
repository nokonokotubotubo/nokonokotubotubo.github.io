<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸRSSãƒ‹ãƒ¥ãƒ¼ã‚¹é–²è¦§ãƒ»ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ">
    <title>ã‚ãªãŸã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</title>
    
    <!-- PWAè¨­å®š -->
    <meta name="theme-color" content="#2196F3">
    <link rel="manifest" href="assets/manifest.json">
    
    <!-- TensorFlow.js CDNï¼ˆä»•æ§˜æ›¸æŒ‡å®šv4.10.0ï¼‰ -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    
    <!-- ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆï¼ˆPhase Cå¯¾å¿œç‰ˆï¼‰ -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/responsive.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/themes.css">
    
    <!-- Phase Cæ‹¡å¼µã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
        /* AIæ©Ÿèƒ½è¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .ai-status-bar {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            color: white;
            padding: 0.5rem 0;
            text-align: center;
            font-size: 0.9rem;
            position: sticky;
            top: 80px;
            z-index: 95;
        }
        
        .ai-status-bar.processing {
            background: linear-gradient(135deg, #FF9800, #FFB74D);
        }
        
        .ai-status-bar.error {
            background: linear-gradient(135deg, #f44336, #EF5350);
        }
        
        /* é«˜åº¦æ¤œç´¢ãƒãƒ¼ */
        .advanced-search {
            background: white;
            padding: 1rem;
            border-bottom: 1px solid #e0e0e0;
            position: sticky;
            top: 120px;
            z-index: 85;
        }
        
        .search-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-input {
            flex: 1;
            min-width: 300px;
            padding: 0.8rem;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33,150,243,0.1);
        }
        
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .suggestion-item {
            padding: 0.8rem;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .suggestion-item:hover {
            background: #f5f5f5;
        }
        
        .search-filters {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .filter-chip {
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 0.4rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .filter-chip.active {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }
        
        /* AIåˆ†æçµæœè¡¨ç¤º */
        .ai-insights {
            background: linear-gradient(135deg, #E3F2FD, #BBDEFB);
            border-left: 4px solid #2196F3;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0 8px 8px 0;
        }
        
        .ai-insights h4 {
            margin: 0 0 0.5rem 0;
            color: #1976D2;
            font-size: 1rem;
        }
        
        .insights-content {
            display: flex;
            gap: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .insight-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #1565C0;
        }
        
        /* è¨˜äº‹è¡¨ç¤ºã‚¨ãƒªã‚¢å¼·åŒ– */
        .articles-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding: 0 1rem;
        }
        
        .articles-count {
            font-size: 1.1rem;
            color: #666;
        }
        
        .view-toggle {
            display: flex;
            gap: 0.5rem;
        }
        
        .view-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .view-btn.active {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }
        
        /* è¨˜äº‹ä¸€è¦§ã®ãƒªã‚¹ãƒˆè¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ */
        .articles-container.list-view {
            display: block;
        }
        
        .articles-container.list-view .article-card {
            display: flex;
            margin-bottom: 1rem;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .articles-container.list-view .article-thumbnail {
            flex: 0 0 200px;
            height: 120px;
        }
        
        .articles-container.list-view .article-info {
            flex: 1;
            padding: 1rem;
        }
        
        /* ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™è¡¨ç¤º */
        .performance-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 1000;
            display: none;
        }
        
        .performance-indicator.show {
            display: block;
        }
        
        /* èª­ã¿è¾¼ã¿çŠ¶æ…‹ã®æ”¹å–„ */
        .loading-message {
            text-align: center;
            padding: 3rem;
            color: #666;
            font-size: 1.1rem;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2196F3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        /* ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒã‚¤ãƒ©ã‚¤ãƒˆå¼·åŒ– */
        .keyword-highlight {
            background: linear-gradient(120deg, #FFEB3B, #FFC107);
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
        }
        
        .matched-keywords .keyword-highlight {
            background: #4CAF50;
            color: white;
            margin-right: 0.3rem;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .search-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-input {
                min-width: unset;
            }
            
            .search-filters {
                justify-content: center;
            }
            
            .articles-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .ai-insights {
                margin: 0 1rem 1rem;
            }
            
            .insights-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€æ›´æ–°ãƒœã‚¿ãƒ³ï¼‰ -->
    <header class="main-header">
        <div class="header-container">
            <h1 class="app-title">ã‚ãªãŸã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</h1>
            <nav class="main-nav">
                <button class="nav-btn active" data-page="index">è¨˜äº‹ä¸€è¦§</button>
                <button class="nav-btn" data-page="rss-manager" onclick="location.href='pages/rss-manager.html'">RSSç®¡ç†</button>
                <button class="nav-btn" data-page="favorites" onclick="location.href='pages/favorites.html'">ãŠæ°—ã«å…¥ã‚Š</button>
                <button class="nav-btn" data-page="settings" onclick="location.href='pages/settings.html'">è¨­å®š</button>
            </nav>
            <button class="refresh-btn" id="refreshBtn">ğŸ”„ æ›´æ–°</button>
        </div>
    </header>

    <!-- AIçŠ¶æ…‹è¡¨ç¤ºãƒãƒ¼ -->
    <div class="ai-status-bar" id="aiStatusBar" style="display: none;">
        <span id="aiStatusText">AIåˆ†ææº–å‚™ä¸­...</span>
    </div>

    <!-- é«˜åº¦æ¤œç´¢ãƒãƒ¼ -->
    <section class="advanced-search">
        <div class="search-container">
            <div style="position: relative; flex: 1; min-width: 300px;">
                <input 
                    type="text" 
                    class="search-input" 
                    id="searchInput"
                    placeholder="è¨˜äº‹ã‚’æ¤œç´¢... (ä¾‹: AI, æŠ€è¡“, ãƒ‹ãƒ¥ãƒ¼ã‚¹)"
                >
                <div class="search-suggestions" id="searchSuggestions"></div>
            </div>
            
            <div class="search-filters">
                <div class="filter-chip" data-filter="interest">é«˜èˆˆå‘³åº¦</div>
                <div class="filter-chip" data-filter="unread">æœªèª­ã®ã¿</div>
                <div class="filter-chip" data-filter="today">ä»Šæ—¥</div>
                <div class="filter-chip" data-filter="ai-recommended">AIæ¨å¥¨</div>
            </div>
        </div>
    </section>

    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒ¼ï¼ˆã‚«ãƒ†ã‚´ãƒªã€æ—¢èª­çŠ¶æ…‹ã€ã‚½ãƒ¼ãƒˆé¸æŠï¼‰ -->
    <section class="filter-bar">
        <div class="filter-container">
            <select class="filter-select" id="categoryFilter">
                <option value="all">å…¨ã‚«ãƒ†ã‚´ãƒª</option>
            </select>
            <select class="filter-select" id="readStatusFilter">
                <option value="all">å…¨ã¦ã®è¨˜äº‹</option>
                <option value="unread">æœªèª­ã®ã¿</option>
                <option value="read">æ—¢èª­ã®ã¿</option>
            </select>
            <select class="filter-select" id="sortFilter">
                <option value="interest">AIèˆˆå‘³åº¦é †</option>
                <option value="date">æ›´æ–°æ—¥æ™‚é †</option>
                <option value="domain">ãƒ‰ãƒ¡ã‚¤ãƒ³é †</option>
                <option value="keyword-match">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è‡´åº¦é †</option>
            </select>
        </div>
    </section>

    <!-- AIåˆ†æçµæœè¡¨ç¤º -->
    <section class="ai-insights" id="aiInsights" style="display: none;">
        <h4>ğŸ¤– AIåˆ†æçµæœ</h4>
        <div class="insights-content" id="insightsContent">
            <!-- å‹•çš„ã«ç”Ÿæˆ -->
        </div>
    </section>

    <!-- è¨˜äº‹ä¸€è¦§ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <section class="articles-header">
        <div class="articles-count">
            <span id="articlesCount">è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...</span>
        </div>
        <div class="view-toggle">
            <button class="view-btn active" data-view="grid">ğŸ“± ã‚«ãƒ¼ãƒ‰è¡¨ç¤º</button>
            <button class="view-btn" data-view="list">ğŸ“„ ãƒªã‚¹ãƒˆè¡¨ç¤º</button>
        </div>
    </section>

    <!-- è¨˜äº‹ä¸€è¦§ã‚¨ãƒªã‚¢ï¼ˆä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œï¼‰ -->
    <main class="main-content">
        <div class="articles-container" id="articlesContainer">
            <div class="loading-message" id="loadingMessage">
                <div class="loading-spinner"></div>
                AIæ©Ÿèƒ½ä»˜ããƒ‹ãƒ¥ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆæœŸåŒ–ä¸­...
            </div>
            <div class="no-articles-message" id="noArticlesMessage" style="display: none;">
                è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚RSSãƒ•ã‚£ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
            </div>
        </div>
    </main>

    <!-- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ï¼ˆRSSè¿½åŠ ã€AIå†å­¦ç¿’ï¼‰ -->
    <div class="floating-actions">
        <button class="fab-btn" id="aiRetrainBtn" title="AIå†å­¦ç¿’" style="bottom: 80px;">
            ğŸ§ 
        </button>
        <button class="fab-btn" id="addRssFab" title="RSSè¿½åŠ ">
            â•
        </button>
    </div>

    <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™ -->
    <div class="performance-indicator" id="performanceIndicator">
        è¨˜äº‹è¡¨ç¤º: <span id="renderTime">-</span>ms | AIå‡¦ç†: <span id="aiProcessTime">-</span>ms
    </div>

    <!-- ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã‚¨ãƒªã‚¢ -->
    <div class="notification-area" id="notificationArea"></div>

    <!-- ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿ï¼ˆä¾å­˜é–¢ä¿‚é †ãƒ»Phase Cå®Œå…¨ç‰ˆï¼‰ -->
    
    <!-- Phase AåŸºç›¤: ãƒ‡ãƒ¼ã‚¿ç®¡ç† -->
    <script src="scripts/data-manager.js"></script>
    
    <!-- Phase CåŸºç›¤: ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ -->
    <script src="scripts/utils.js"></script>
    
    <!-- Phase Bæ©Ÿèƒ½: RSSå–å¾—ãƒ»è¡¨ç¤ºãƒ»æ“ä½œ -->
    <script src="scripts/rss-fetcher.js"></script>
    <script src="scripts/article-card.js"></script>
    <script src="scripts/ui-controller.js"></script>
    
    <!-- Phase Cæ©Ÿèƒ½: AIå‡¦ç† -->
    <script src="scripts/ai-engine.js"></script>
    
    <!-- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ±åˆãƒ»åˆæœŸåŒ–ï¼ˆå¿…ãšæœ€å¾Œï¼‰ -->
    <script src="scripts/app.js"></script>
    
    <!-- Phase Cçµ±åˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script>
        // Phase Cæ©Ÿèƒ½æ‹¡å¼µ
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // AIæ©Ÿèƒ½çµ±åˆãƒã‚§ãƒƒã‚¯
                if (window.yourNewsApp && typeof AIEngine !== 'undefined') {
                    console.log('Phase Cæ©Ÿèƒ½çµ±åˆç¢ºèª: AI Engineåˆ©ç”¨å¯èƒ½');
                    
                    // AI EngineåˆæœŸåŒ–
                    window.yourNewsApp.aiEngine = new AIEngine();
                    await window.yourNewsApp.aiEngine.initialize();
                    
                    // AIçŠ¶æ…‹è¡¨ç¤ºæ›´æ–°
                    const aiStatusBar = document.getElementById('aiStatusBar');
                    const aiStatusText = document.getElementById('aiStatusText');
                    
                    if (aiStatusBar && aiStatusText) {
                        aiStatusBar.style.display = 'block';
                        aiStatusText.textContent = 'ğŸ¤– AIæ©Ÿèƒ½æº–å‚™å®Œäº†';
                        aiStatusBar.className = 'ai-status-bar';
                        
                        setTimeout(() => {
                            aiStatusBar.style.display = 'none';
                        }, 3000);
                    }
                    
                    // AIæ¨å¥¨è¨˜äº‹ç”Ÿæˆ
                    await setupAIFeatures();
                }
                
                // Phase Cé«˜åº¦æ¤œç´¢æ©Ÿèƒ½
                setupAdvancedSearch();
                
                // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
                setupPerformanceMonitoring();
                
            } catch (error) {
                console.error('Phase Cæ©Ÿèƒ½çµ±åˆã‚¨ãƒ©ãƒ¼:', error);
            }
        });
        
        async function setupAIFeatures() {
            try {
                if (!window.yourNewsApp.aiEngine) return;
                
                // AIå†å­¦ç¿’ãƒœã‚¿ãƒ³
                const aiRetrainBtn = document.getElementById('aiRetrainBtn');
                if (aiRetrainBtn) {
                    aiRetrainBtn.addEventListener('click', async () => {
                        try {
                            aiRetrainBtn.disabled = true;
                            aiRetrainBtn.textContent = 'ğŸ”„';
                            
                            // AIå†å­¦ç¿’å®Ÿè¡Œ
                            const articles = await window.yourNewsApp.dataManager.loadArticles();
                            const keywords = await window.yourNewsApp.dataManager.loadData('yourNews_keywords') || 
                                           { interestWords: [], ngWords: [] };
                            
                            for (const article of articles) {
                                await window.yourNewsApp.aiEngine.calculateInterestScore(article, keywords);
                            }
                            
                            await window.yourNewsApp.dataManager.saveArticles(articles);
                            
                            // UIæ›´æ–°
                            if (window.yourNewsApp.uiController) {
                                await window.yourNewsApp.uiController.loadAndDisplayArticles(true);
                            }
                            
                            window.yourNewsApp.showNotification('AIå†å­¦ç¿’ãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
                            
                        } catch (error) {
                            console.error('AIå†å­¦ç¿’ã‚¨ãƒ©ãƒ¼:', error);
                            window.yourNewsApp.showNotification('AIå†å­¦ç¿’ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                        } finally {
                            aiRetrainBtn.disabled = false;
                            aiRetrainBtn.textContent = 'ğŸ§ ';
                        }
                    });
                }
                
                // AIåˆ†æçµæœè¡¨ç¤º
                updateAIInsights();
                
            } catch (error) {
                console.error('AIæ©Ÿèƒ½è¨­å®šã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        function setupAdvancedSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchSuggestions = document.getElementById('searchSuggestions');
            
            if (searchInput) {
                // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢
                searchInput.addEventListener('input', Utils.debounce(async (e) => {
                    const query = e.target.value.trim();
                    
                    if (query.length > 1) {
                        await performAdvancedSearch(query);
                        showSearchSuggestions(query);
                    } else {
                        hideSearchSuggestions();
                        // å…¨è¨˜äº‹è¡¨ç¤ºã«æˆ»ã™
                        if (window.yourNewsApp.uiController) {
                            window.yourNewsApp.uiController.applyFilters();
                        }
                    }
                }, 300));
                
                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã®å‡¦ç†
                searchInput.addEventListener('focus', () => {
                    if (searchInput.value.trim()) {
                        showSearchSuggestions(searchInput.value.trim());
                    }
                });
                
                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å¤–ã—ã§å€™è£œéè¡¨ç¤º
                document.addEventListener('click', (e) => {
                    if (!searchInput.contains(e.target) && !searchSuggestions.contains(e.target)) {
                        hideSearchSuggestions();
                    }
                });
            }
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒãƒ—
            const filterChips = document.querySelectorAll('.filter-chip');
            filterChips.forEach(chip => {
                chip.addEventListener('click', () => {
                    chip.classList.toggle('active');
                    applyFilterChips();
                });
            });
            
            // è¡¨ç¤ºåˆ‡æ›¿
            const viewBtns = document.querySelectorAll('.view-btn');
            viewBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    viewBtns.forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    
                    const view = e.target.dataset.view;
                    const container = document.getElementById('articlesContainer');
                    if (container) {
                        container.className = `articles-container ${view}-view`;
                    }
                });
            });
        }
        
        async function performAdvancedSearch(query) {
            try {
                if (!window.yourNewsApp.uiController) return;
                
                // é«˜åº¦æ¤œç´¢å®Ÿè¡Œ
                const articles = window.yourNewsApp.uiController.getCurrentArticles();
                const searchResults = articles.filter(article => {
                    const searchText = (article.title + ' ' + article.excerpt + ' ' + article.domain).toLowerCase();
                    return searchText.includes(query.toLowerCase());
                });
                
                // çµæœè¡¨ç¤º
                window.yourNewsApp.uiController.filteredArticles = searchResults;
                window.yourNewsApp.uiController.renderArticles();
                
                // è¨˜äº‹æ•°æ›´æ–°
                updateArticlesCount(searchResults.length, articles.length);
                
            } catch (error) {
                console.error('é«˜åº¦æ¤œç´¢ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        function showSearchSuggestions(query) {
            // æ¤œç´¢å€™è£œè¡¨ç¤ºï¼ˆå®Ÿè£…ä¾‹ï¼‰
            const suggestions = [
                'æœ€æ–°æŠ€è¡“',
                'AI ãƒ‹ãƒ¥ãƒ¼ã‚¹',
                'çµŒæ¸ˆå‹•å‘',
                'ã‚¹ãƒãƒ¼ãƒ„çµæœ'
            ].filter(s => s.toLowerCase().includes(query.toLowerCase()));
            
            const suggestionsContainer = document.getElementById('searchSuggestions');
            if (suggestionsContainer && suggestions.length > 0) {
                suggestionsContainer.innerHTML = suggestions.map(s => 
                    `<div class="suggestion-item" onclick="selectSuggestion('${s}')">${s}</div>`
                ).join('');
                suggestionsContainer.style.display = 'block';
            }
        }
        
        function hideSearchSuggestions() {
            const suggestionsContainer = document.getElementById('searchSuggestions');
            if (suggestionsContainer) {
                suggestionsContainer.style.display = 'none';
            }
        }
        
        function selectSuggestion(suggestion) {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.value = suggestion;
                performAdvancedSearch(suggestion);
            }
            hideSearchSuggestions();
        }
        
        function applyFilterChips() {
            const activeChips = document.querySelectorAll('.filter-chip.active');
            const filters = Array.from(activeChips).map(chip => chip.dataset.filter);
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆä¾‹ï¼‰
            console.log('ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼:', filters);
            
            if (window.yourNewsApp.uiController) {
                // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ã‚’å®Ÿè£…
                window.yourNewsApp.uiController.applyAdvancedFilters(filters);
            }
        }
        
        function updateArticlesCount(filtered, total) {
            const countElement = document.getElementById('articlesCount');
            if (countElement) {
                if (filtered === total) {
                    countElement.textContent = `${total}ä»¶ã®è¨˜äº‹`;
                } else {
                    countElement.textContent = `${filtered}ä»¶ã®è¨˜äº‹ï¼ˆå…¨${total}ä»¶ä¸­ï¼‰`;
                }
            }
        }
        
        async function updateAIInsights() {
            try {
                if (!window.yourNewsApp.aiEngine) return;
                
                const insights = document.getElementById('aiInsights');
                const insightsContent = document.getElementById('insightsContent');
                
                if (insights && insightsContent) {
                    const stats = window.yourNewsApp.aiEngine.getStats();
                    
                    insightsContent.innerHTML = `
                        <div class="insight-item">
                            <span>ğŸ“Š</span>
                            <span>å­¦ç¿’æ¸ˆã¿èªå½™: ${stats.vocabularySize}èª</span>
                        </div>
                        <div class="insight-item">
                            <span>ğŸ“ˆ</span>
                            <span>ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å±¥æ­´: ${stats.feedbackCount}ä»¶</span>
                        </div>
                        <div class="insight-item">
                            <span>ğŸ¯</span>
                            <span>AIåˆ†æç²¾åº¦: ${Math.round(stats.avgIDF * 100)}%</span>
                        </div>
                    `;
                    
                    insights.style.display = 'block';
                }
                
            } catch (error) {
                console.error('AIåˆ†æçµæœæ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        function setupPerformanceMonitoring() {
            // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
            let renderStartTime = 0;
            let aiProcessStartTime = 0;
            
            // è¨˜äº‹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–‹å§‹
            window.addEventListener('articlesRenderStart', () => {
                renderStartTime = performance.now();
            });
            
            // è¨˜äº‹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å®Œäº†
            window.addEventListener('articlesRenderComplete', () => {
                const renderTime = Math.round(performance.now() - renderStartTime);
                const renderTimeElement = document.getElementById('renderTime');
                if (renderTimeElement) {
                    renderTimeElement.textContent = renderTime;
                }
                
                // ä¸€å®šæ™‚é–“è¡¨ç¤º
                const indicator = document.getElementById('performanceIndicator');
                if (indicator) {
                    indicator.classList.add('show');
                    setTimeout(() => {
                        indicator.classList.remove('show');
                    }, 3000);
                }
            });
            
            // AIå‡¦ç†æ™‚é–“ç›£è¦–
            window.addEventListener('aiProcessStart', () => {
                aiProcessStartTime = performance.now();
            });
            
            window.addEventListener('aiProcessComplete', () => {
                const aiProcessTime = Math.round(performance.now() - aiProcessStartTime);
                const aiProcessTimeElement = document.getElementById('aiProcessTime');
                if (aiProcessTimeElement) {
                    aiProcessTimeElement.textContent = aiProcessTime;
                }
            });
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
        window.selectSuggestion = selectSuggestion;
    </script>
</body>
</html>
