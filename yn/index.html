<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AIæ©Ÿèƒ½ä»˜ããƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸRSSãƒ‹ãƒ¥ãƒ¼ã‚¹é–²è¦§ãƒ»ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ">
    <title>ã‚ãªãŸã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</title>
    
    <!-- PWAè¨­å®šï¼ˆå¿…é ˆï¼‰ -->
    <meta name="theme-color" content="#2196F3">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ã‚ãªãŸã®ãƒ‹ãƒ¥ãƒ¼ã‚¹">
    <meta name="msapplication-TileColor" content="#2196F3">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="assets/manifest.json">
    
    <!-- Apple PWA ã‚¢ã‚¤ã‚³ãƒ³ -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjE5MiIgaGVpZ2h0PSIxOTIiIGZpbGw9IiMyMTk2RjMiIHJ4PSIzMiIvPjx0ZXh0IHg9Ijk2IiB5PSIxMjAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSI5NiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5OPC90ZXh0Pjwvc3ZnPg==">
    
    <!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIGZpbGw9IiMyMTk2RjMiIHJ4PSI4Ii8+PHRleHQgeD0iMjQiIHk9IjMwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjQiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+TjwvdGV4dD48L3N2Zz4=">
    
    <!-- TensorFlow.js CDNï¼ˆä»•æ§˜æ›¸æŒ‡å®šv4.10.0ï¼‰ -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    
    <!-- ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆï¼ˆPhase Cå¯¾å¿œç‰ˆï¼‰ -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/responsive.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/themes.css">
    
    <!-- Phase Cæ‹¡å¼µã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
        /* AIæ©Ÿèƒ½è¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .ai-status-bar {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            color: white;
            padding: 0.5rem 0;
            text-align: center;
            font-size: 0.9rem;
            position: sticky;
            top: 80px;
            z-index: 95;
            transition: all 0.3s ease;
        }
        
        .ai-status-bar.processing {
            background: linear-gradient(135deg, #FF9800, #FFB74D);
        }
        
        .ai-status-bar.error {
            background: linear-gradient(135deg, #f44336, #EF5350);
        }
        
        .ai-status-bar.hidden {
            transform: translateY(-100%);
            opacity: 0;
        }
        
        /* é«˜åº¦æ¤œç´¢ãƒãƒ¼ */
        .advanced-search {
            background: white;
            padding: 1rem;
            border-bottom: 1px solid #e0e0e0;
            position: sticky;
            top: 120px;
            z-index: 85;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .search-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-input-wrapper {
            position: relative;
            flex: 1;
            min-width: 300px;
        }
        
        .search-input {
            width: 100%;
            padding: 0.8rem 1rem 0.8rem 2.5rem;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33,150,243,0.1);
            background: white;
        }
        
        .search-icon {
            position: absolute;
            left: 0.8rem;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            font-size: 1.1rem;
        }
        
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .suggestion-item {
            padding: 0.8rem;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s ease;
        }
        
        .suggestion-item:hover {
            background: #f5f5f5;
        }
        
        .suggestion-item:last-child {
            border-bottom: none;
        }
        
        .search-filters {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .filter-chip {
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 0.4rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }
        
        .filter-chip:hover {
            background: #e0e0e0;
        }
        
        .filter-chip.active {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }
        
        /* AIåˆ†æçµæœè¡¨ç¤º */
        .ai-insights {
            background: linear-gradient(135deg, #E3F2FD, #BBDEFB);
            border-left: 4px solid #2196F3;
            padding: 1rem;
            margin: 0 1rem 1rem;
            border-radius: 0 8px 8px 0;
            transition: all 0.3s ease;
        }
        
        .ai-insights h4 {
            margin: 0 0 0.5rem 0;
            color: #1976D2;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .insights-content {
            display: flex;
            gap: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .insight-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #1565C0;
            background: rgba(255,255,255,0.7);
            padding: 0.3rem 0.6rem;
            border-radius: 12px;
        }
        
        /* è¨˜äº‹è¡¨ç¤ºã‚¨ãƒªã‚¢å¼·åŒ– */
        .articles-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding: 0 1rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 1rem;
        }
        
        .articles-count {
            font-size: 1.1rem;
            color: #666;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .count-badge {
            background: #2196F3;
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            background: #f0f0f0;
            border-radius: 6px;
            padding: 0.2rem;
        }
        
        .view-btn {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }
        
        .view-btn.active {
            background: #2196F3;
            color: white;
            box-shadow: 0 2px 4px rgba(33,150,243,0.3);
        }
        
        /* è¨˜äº‹ä¸€è¦§ã®ãƒªã‚¹ãƒˆè¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ */
        .articles-container.list-view {
            display: block;
        }
        
        .articles-container.list-view .article-card {
            display: flex;
            margin-bottom: 1rem;
            border-radius: 8px;
            overflow: hidden;
            max-height: 150px;
        }
        
        .articles-container.list-view .article-thumbnail {
            flex: 0 0 200px;
            height: 120px;
        }
        
        .articles-container.list-view .article-info {
            flex: 1;
            padding: 1rem;
        }
        
        .articles-container.list-view .card-actions {
            flex: 0 0 auto;
            padding: 1rem;
            align-items: center;
        }
        
        /* ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™è¡¨ç¤º */
        .performance-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 1000;
            display: none;
            transition: all 0.3s ease;
        }
        
        .performance-indicator.show {
            display: block;
            animation: slideInLeft 0.3s ease;
        }
        
        @keyframes slideInLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* èª­ã¿è¾¼ã¿çŠ¶æ…‹ã®æ”¹å–„ */
        .loading-message {
            text-align: center;
            padding: 3rem;
            color: #666;
            font-size: 1.1rem;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2196F3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒã‚¤ãƒ©ã‚¤ãƒˆå¼·åŒ– */
        .keyword-highlight {
            background: linear-gradient(120deg, #FFEB3B, #FFC107);
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .matched-keywords .keyword-highlight {
            background: #4CAF50;
            color: white;
            margin-right: 0.3rem;
        }
        
        /* PWAé–¢é€£ã‚¹ã‚¿ã‚¤ãƒ« */
        .pwa-install-prompt {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            max-width: 300px;
            z-index: 1001;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .pwa-install-prompt.show {
            transform: translateX(0);
        }
        
        .install-prompt-header {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .install-prompt-body {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1rem;
        }
        
        .install-prompt-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }
        
        .install-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .dismiss-btn {
            background: #666;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        /* ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ…‹è¡¨ç¤º */
        .network-status {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            z-index: 1001;
            transition: opacity 0.3s ease;
        }
        
        .network-status.online {
            background: rgba(76,175,80,0.9);
            color: white;
        }
        
        .network-status.offline {
            background: rgba(244,67,54,0.9);
            color: white;
        }
        
        /* ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³å¼·åŒ– */
        .floating-actions {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            z-index: 999;
        }
        
        .fab-btn {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            background: #2196F3;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .fab-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        .fab-btn.install-btn {
            background: #4CAF50;
        }
        
        .fab-btn.ai-retrain-btn {
            background: #9C27B0;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .search-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-input-wrapper {
                min-width: unset;
            }
            
            .search-filters {
                justify-content: center;
            }
            
            .articles-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .ai-insights {
                margin: 0 0.5rem 1rem;
                padding: 0.8rem;
            }
            
            .insights-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .advanced-search {
                position: static;
            }
            
            .ai-status-bar {
                position: static;
            }
            
            .floating-actions {
                bottom: 10px;
                right: 10px;
            }
            
            .fab-btn {
                width: 48px;
                height: 48px;
                font-size: 1.2rem;
            }
        }
        
        @media (max-width: 480px) {
            .search-filters {
                gap: 0.3rem;
            }
            
            .filter-chip {
                padding: 0.3rem 0.8rem;
                font-size: 0.8rem;
            }
            
            .articles-count {
                font-size: 1rem;
            }
            
            .view-toggle {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ */
        @media (prefers-color-scheme: dark) {
            .advanced-search {
                background: #2E2E2E;
                border-bottom-color: #444;
            }
            
            .search-input {
                background: #3A3A3A;
                border-color: #555;
                color: #E0E0E0;
            }
            
            .search-input:focus {
                border-color: #64B5F6;
                background: #2E2E2E;
            }
            
            .articles-header {
                background: #2E2E2E;
                color: #E0E0E0;
            }
            
            .ai-insights {
                background: linear-gradient(135deg, #1A237E, #283593);
                border-left-color: #64B5F6;
            }
            
            .insight-item {
                background: rgba(255,255,255,0.1);
                color: #BBDEFB;
            }
        }
        
        /* å°åˆ·ã‚¹ã‚¿ã‚¤ãƒ« */
        @media print {
            .advanced-search,
            .ai-status-bar,
            .floating-actions,
            .performance-indicator,
            .pwa-install-prompt {
                display: none;
            }
            
            .articles-header {
                box-shadow: none;
                border: 1px solid #000;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€æ›´æ–°ãƒœã‚¿ãƒ³ï¼‰ -->
    <header class="main-header">
        <div class="header-container">
            <h1 class="app-title">ã‚ãªãŸã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</h1>
            <nav class="main-nav">
                <button class="nav-btn active" data-page="index">è¨˜äº‹ä¸€è¦§</button>
                <button class="nav-btn" data-page="rss-manager" onclick="location.href='pages/rss-manager.html'">RSSç®¡ç†</button>
                <button class="nav-btn" data-page="favorites" onclick="location.href='pages/favorites.html'">ãŠæ°—ã«å…¥ã‚Š</button>
                <button class="nav-btn" data-page="settings" onclick="location.href='pages/settings.html'">è¨­å®š</button>
            </nav>
            <button class="refresh-btn" id="refreshBtn" title="è¨˜äº‹ã‚’æ›´æ–°">ğŸ”„ æ›´æ–°</button>
        </div>
    </header>

    <!-- AIçŠ¶æ…‹è¡¨ç¤ºãƒãƒ¼ -->
    <div class="ai-status-bar hidden" id="aiStatusBar">
        <span id="aiStatusText">AIåˆ†ææº–å‚™ä¸­...</span>
    </div>

    <!-- é«˜åº¦æ¤œç´¢ãƒãƒ¼ -->
    <section class="advanced-search">
        <div class="search-container">
            <div class="search-input-wrapper">
                <div class="search-icon">ğŸ”</div>
                <input 
                    type="text" 
                    class="search-input" 
                    id="searchInput"
                    placeholder="è¨˜äº‹ã‚’æ¤œç´¢... (ä¾‹: AI, æŠ€è¡“, ãƒ‹ãƒ¥ãƒ¼ã‚¹)"
                    autocomplete="off"
                >
                <div class="search-suggestions" id="searchSuggestions"></div>
            </div>
            
            <div class="search-filters">
                <div class="filter-chip" data-filter="interest" title="AIèˆˆå‘³åº¦ã®é«˜ã„è¨˜äº‹">é«˜èˆˆå‘³åº¦</div>
                <div class="filter-chip" data-filter="unread" title="æœªèª­è¨˜äº‹ã®ã¿">æœªèª­ã®ã¿</div>
                <div class="filter-chip" data-filter="today" title="ä»Šæ—¥å…¬é–‹ã®è¨˜äº‹">ä»Šæ—¥</div>
                <div class="filter-chip" data-filter="ai-recommended" title="AIæ¨å¥¨è¨˜äº‹">AIæ¨å¥¨</div>
            </div>
        </div>
    </section>

    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒ¼ï¼ˆã‚«ãƒ†ã‚´ãƒªã€æ—¢èª­çŠ¶æ…‹ã€ã‚½ãƒ¼ãƒˆé¸æŠï¼‰ -->
    <section class="filter-bar">
        <div class="filter-container">
            <select class="filter-select" id="categoryFilter" title="ã‚«ãƒ†ã‚´ãƒªã§çµã‚Šè¾¼ã¿">
                <option value="all">å…¨ã‚«ãƒ†ã‚´ãƒª</option>
            </select>
            <select class="filter-select" id="readStatusFilter" title="æ—¢èª­çŠ¶æ…‹ã§çµã‚Šè¾¼ã¿">
                <option value="all">å…¨ã¦ã®è¨˜äº‹</option>
                <option value="unread">æœªèª­ã®ã¿</option>
                <option value="read">æ—¢èª­ã®ã¿</option>
            </select>
            <select class="filter-select" id="sortFilter" title="ä¸¦ã³é †ã‚’é¸æŠ">
                <option value="interest">AIèˆˆå‘³åº¦é †</option>
                <option value="date">æ›´æ–°æ—¥æ™‚é †</option>
                <option value="domain">ãƒ‰ãƒ¡ã‚¤ãƒ³é †</option>
                <option value="keyword-match">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è‡´åº¦é †</option>
            </select>
        </div>
    </section>

    <!-- AIåˆ†æçµæœè¡¨ç¤º -->
    <section class="ai-insights" id="aiInsights" style="display: none;">
        <h4>ğŸ¤– AIåˆ†æçµæœ</h4>
        <div class="insights-content" id="insightsContent">
            <!-- å‹•çš„ã«ç”Ÿæˆ -->
        </div>
    </section>

    <!-- è¨˜äº‹ä¸€è¦§ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <section class="articles-header">
        <div class="articles-count">
            <span>ğŸ“°</span>
            <span id="articlesCount">è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...</span>
            <span class="count-badge" id="unreadBadge">0</span>
        </div>
        <div class="view-toggle">
            <button class="view-btn active" data-view="grid" title="ã‚«ãƒ¼ãƒ‰è¡¨ç¤º">ğŸ“± ã‚«ãƒ¼ãƒ‰</button>
            <button class="view-btn" data-view="list" title="ãƒªã‚¹ãƒˆè¡¨ç¤º">ğŸ“„ ãƒªã‚¹ãƒˆ</button>
        </div>
    </section>

    <!-- è¨˜äº‹ä¸€è¦§ã‚¨ãƒªã‚¢ï¼ˆä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œï¼‰ -->
    <main class="main-content">
        <div class="articles-container" id="articlesContainer">
            <div class="loading-message" id="loadingMessage">
                <div class="loading-spinner"></div>
                <div>AIæ©Ÿèƒ½ä»˜ããƒ‹ãƒ¥ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆæœŸåŒ–ä¸­...</div>
                <div style="font-size: 0.9rem; color: #999; margin-top: 0.5rem;">
                    TensorFlow.jsèª­ã¿è¾¼ã¿ãƒ»RSSå–å¾—ãƒ»AIåˆ†æã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™
                </div>
            </div>
            <div class="no-articles-message" id="noArticlesMessage" style="display: none;">
                <div style="text-align: center; padding: 3rem; color: #666;">
                    <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ“°</div>
                    <h3>è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“</h3>
                    <p>RSSãƒ•ã‚£ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦è¨˜äº‹ã‚’å–å¾—ã—ã¦ãã ã•ã„</p>
                    <button class="btn btn-primary" onclick="location.href='pages/rss-manager.html'">
                        RSSç®¡ç†ç”»é¢ã¸
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ï¼ˆRSSè¿½åŠ ã€AIå†å­¦ç¿’ï¼‰ -->
    <div class="floating-actions">
        <button class="fab-btn ai-retrain-btn" id="aiRetrainBtn" title="AIå†å­¦ç¿’ã‚’å®Ÿè¡Œ">
            ğŸ§ 
        </button>
        <button class="fab-btn" id="addRssFab" title="RSSè¿½åŠ ç”»é¢ã¸" onclick="location.href='pages/rss-manager.html'">
            â•
        </button>
    </div>

    <!-- PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ -->
    <div class="pwa-install-prompt" id="pwaInstallPrompt">
        <div class="install-prompt-header">ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</div>
        <div class="install-prompt-body">
            ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã—ã¦ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚åˆ©ç”¨ã§ãã¾ã™
        </div>
        <div class="install-prompt-actions">
            <button class="dismiss-btn" id="dismissInstallBtn">å¾Œã§</button>
            <button class="install-btn" id="installAppBtn">ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</button>
        </div>
    </div>

    <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™ -->
    <div class="performance-indicator" id="performanceIndicator">
        <span>è¨˜äº‹è¡¨ç¤º: <span id="renderTime">-</span>ms</span>
        <span> | </span>
        <span>AIå‡¦ç†: <span id="aiProcessTime">-</span>ms</span>
    </div>

    <!-- ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã‚¨ãƒªã‚¢ -->
    <div class="notification-area" id="notificationArea"></div>

    <!-- ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿ï¼ˆä¾å­˜é–¢ä¿‚é †ãƒ»Phase Cå®Œå…¨ç‰ˆï¼‰ -->
    
    <!-- Phase AåŸºç›¤: ãƒ‡ãƒ¼ã‚¿ç®¡ç† -->
    <script src="scripts/data-manager.js"></script>
    
    <!-- Phase CåŸºç›¤: ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ -->
    <script src="scripts/utils.js"></script>
    
    <!-- Phase Bæ©Ÿèƒ½: RSSå–å¾—ãƒ»è¡¨ç¤ºãƒ»æ“ä½œ -->
    <script src="scripts/rss-fetcher.js"></script>
    <script src="scripts/article-card.js"></script>
    <script src="scripts/ui-controller.js"></script>
    
    <!-- Phase Cæ©Ÿèƒ½: AIå‡¦ç† -->
    <script src="scripts/ai-engine.js"></script>
    
    <!-- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ±åˆãƒ»åˆæœŸåŒ–ï¼ˆå¿…ãšæœ€å¾Œï¼‰ -->
    <script src="scripts/app.js"></script>
    
    <!-- Phase Cçµ±åˆãƒ»PWAå¯¾å¿œã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script>
        // PWAæ©Ÿèƒ½åˆæœŸåŒ–ã‚¯ãƒ©ã‚¹
        class PWAManager {
            constructor() {
                this.deferredPrompt = null;
                this.isOnline = navigator.onLine;
                this.serviceWorker = null;
            }
            
            async initialize() {
                try {
                    console.log('PWA ManageråˆæœŸåŒ–é–‹å§‹');
                    
                    // Service Workerç™»éŒ²
                    await this.registerServiceWorker();
                    
                    // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæº–å‚™
                    this.setupInstallPrompt();
                    
                    // ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ»ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ç›£è¦–
                    this.setupNetworkMonitoring();
                    
                    // ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰åŒæœŸè¨­å®š
                    this.setupBackgroundSync();
                    
                    // PWAçŠ¶æ…‹è¡¨ç¤º
                    this.updatePWAStatus();
                    
                    console.log('PWA ManageråˆæœŸåŒ–å®Œäº†');
                    return true;
                    
                } catch (error) {
                    console.error('PWA ManageråˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                    return false;
                }
            }
            
            async registerServiceWorker() {
                if ('serviceWorker' in navigator) {
                    try {
                        const registration = await navigator.serviceWorker.register('/sw.js');
                        this.serviceWorker = registration;
                        
                        console.log('Service Workerç™»éŒ²æˆåŠŸ:', registration.scope);
                        
                        // æ›´æ–°ãƒã‚§ãƒƒã‚¯
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    this.showUpdateAvailable();
                                }
                            });
                        });
                        
                        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡
                        navigator.serviceWorker.addEventListener('message', event => {
                            this.handleServiceWorkerMessage(event.data);
                        });
                        
                        return registration;
                        
                    } catch (error) {
                        console.error('Service Workerç™»éŒ²å¤±æ•—:', error);
                        throw error;
                    }
                } else {
                    console.warn('Service Worker not supported');
                    return null;
                }
            }
            
            setupInstallPrompt() {
                // PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
                window.addEventListener('beforeinstallprompt', (e) => {
                    console.log('PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæº–å‚™');
                    e.preventDefault();
                    this.deferredPrompt = e;
                    this.showInstallPrompt();
                });
                
                // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†æ¤œå‡º
                window.addEventListener('appinstalled', () => {
                    console.log('PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†');
                    this.hideInstallPrompt();
                    this.deferredPrompt = null;
                    
                    if (window.yourNewsApp && window.yourNewsApp.showNotification) {
                        window.yourNewsApp.showNotification(
                            'ã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã—ãŸï¼ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚åˆ©ç”¨ã§ãã¾ã™ã€‚',
                            'success',
                            5000
                        );
                    }
                });
            }
            
            setupNetworkMonitoring() {
                // ã‚ªãƒ³ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ç›£è¦–
                window.addEventListener('online', () => {
                    console.log('ã‚ªãƒ³ãƒ©ã‚¤ãƒ³çŠ¶æ…‹æ¤œå‡º');
                    this.isOnline = true;
                    this.updateNetworkStatus(true);
                    this.syncWhenOnline();
                });
                
                window.addEventListener('offline', () => {
                    console.log('ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹æ¤œå‡º');
                    this.isOnline = false;
                    this.updateNetworkStatus(false);
                });
            }
            
            setupBackgroundSync() {
                if ('serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {
                    // ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰åŒæœŸç™»éŒ²
                    navigator.serviceWorker.ready.then(registration => {
                        // RSSè‡ªå‹•æ›´æ–°åŒæœŸ
                        const settings = JSON.parse(localStorage.getItem('yourNews_settings') || '{}');
                        if (settings.rss?.autoRefresh) {
                            registration.sync.register('background-rss-fetch');
                            console.log('ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰RSSåŒæœŸç™»éŒ²å®Œäº†');
                        }
                        
                        // AIå­¦ç¿’åŒæœŸ
                        registration.sync.register('background-ai-learning');
                        console.log('ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰AIå­¦ç¿’åŒæœŸç™»éŒ²å®Œäº†');
                    });
                }
            }
            
            showInstallPrompt() {
                const prompt = document.getElementById('pwaInstallPrompt');
                if (prompt) {
                    prompt.classList.add('show');
                    
                    // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³
                    const installBtn = document.getElementById('installAppBtn');
                    const dismissBtn = document.getElementById('dismissInstallBtn');
                    
                    if (installBtn) {
                        installBtn.onclick = () => this.triggerInstall();
                    }
                    
                    if (dismissBtn) {
                        dismissBtn.onclick = () => this.hideInstallPrompt();
                    }
                    
                    // 30ç§’å¾Œã«è‡ªå‹•ã§éè¡¨ç¤º
                    setTimeout(() => {
                        this.hideInstallPrompt();
                    }, 30000);
                }
            }
            
            hideInstallPrompt() {
                const prompt = document.getElementById('pwaInstallPrompt');
                if (prompt) {
                    prompt.classList.remove('show');
                }
            }
            
            async triggerInstall() {
                if (!this.deferredPrompt) return false;
                
                try {
                    this.deferredPrompt.prompt();
                    const { outcome } = await this.deferredPrompt.userChoice;
                    
                    console.log('ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆçµæœ:', outcome);
                    
                    if (outcome === 'accepted') {
                        console.log('ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒPWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æ‰¿èª');
                    }
                    
                    this.deferredPrompt = null;
                    this.hideInstallPrompt();
                    
                    return outcome === 'accepted';
                    
                } catch (error) {
                    console.error('ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                    return false;
                }
            }
            
            updateNetworkStatus(online) {
                // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ…‹è¡¨ç¤º
                let statusIndicator = document.getElementById('network-status');
                if (!statusIndicator) {
                    statusIndicator = document.createElement('div');
                    statusIndicator.id = 'network-status';
                    statusIndicator.className = 'network-status';
                    document.body.appendChild(statusIndicator);
                }
                
                statusIndicator.className = `network-status ${online ? 'online' : 'offline'}`;
                statusIndicator.textContent = online ? 'ğŸŒ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¾©å¸°' : 'ğŸ“´ ã‚ªãƒ•ãƒ©ã‚¤ãƒ³';
                
                // 5ç§’å¾Œã«éè¡¨ç¤º
                setTimeout(() => {
                    if (statusIndicator) {
                        statusIndicator.style.opacity = '0';
                        setTimeout(() => {
                            if (statusIndicator.parentElement) {
                                statusIndicator.remove();
                            }
                        }, 300);
                    }
                }, 5000);
            }
            
            async syncWhenOnline() {
                if (!this.isOnline) return;
                
                try {
                    console.log('ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¾©å¸°æ™‚ã®åŒæœŸé–‹å§‹');
                    
                    // Service Workerã«åŒæœŸæŒ‡ç¤º
                    if (this.serviceWorker && this.serviceWorker.sync) {
                        await this.serviceWorker.sync.register('background-rss-fetch');
                        await this.serviceWorker.sync.register('background-ai-learning');
                    }
                    
                    // RSSå¼·åˆ¶æ›´æ–°
                    if (window.yourNewsApp && window.yourNewsApp.uiController) {
                        window.yourNewsApp.uiController.loadAndDisplayArticles(true);
                    }
                    
                } catch (error) {
                    console.error('ã‚ªãƒ³ãƒ©ã‚¤ãƒ³åŒæœŸã‚¨ãƒ©ãƒ¼:', error);
                }
            }
            
            updatePWAStatus() {
                // PWAçŠ¶æ…‹ã‚’è¡¨ç¤ºã‚¨ãƒªã‚¢ã«åæ˜ 
                const isStandalone = window.matchMedia('(display-mode: standalone)').matches ||
                                    window.navigator.standalone ||
                                    document.referrer.includes('android-app://');
                
                if (isStandalone) {
                    console.log('PWAã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œä¸­');
                    document.body.classList.add('pwa-standalone');
                } else {
                    console.log('ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œä¸­');
                    document.body.classList.add('pwa-browser');
                }
            }
            
            handleServiceWorkerMessage(data) {
                console.log('Service Workerãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡:', data);
                
                switch (data.type) {
                    case 'BACKGROUND_RSS_UPDATE':
                        this.handleBackgroundRSSUpdate(data);
                        break;
                        
                    case 'BACKGROUND_AI_UPDATE':
                        this.handleBackgroundAIUpdate(data);
                        break;
                        
                    case 'NETWORK_STATUS_CHANGE':
                        this.updateNetworkStatus(data.online);
                        break;
                }
            }
            
            handleBackgroundRSSUpdate(data) {
                if (window.yourNewsApp && window.yourNewsApp.showNotification) {
                    const message = `ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§RSSã‚’æ›´æ–°ï¼ˆ${data.successCount}/${data.totalCount}ä»¶æˆåŠŸï¼‰`;
                    window.yourNewsApp.showNotification(message, 'info', 3000);
                }
                
                // UIæ›´æ–°
                if (window.yourNewsApp && window.yourNewsApp.uiController) {
                    window.yourNewsApp.uiController.loadAndDisplayArticles(true);
                }
            }
            
            handleBackgroundAIUpdate(data) {
                if (window.yourNewsApp && window.yourNewsApp.showNotification) {
                    const message = `AIãŒ${data.processedCount}ä»¶ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å­¦ç¿’ã—ã¾ã—ãŸ`;
                    window.yourNewsApp.showNotification(message, 'success', 2000);
                }
            }
        }
        
        // Phase Cæ©Ÿèƒ½æ‹¡å¼µ
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // AIæ©Ÿèƒ½çµ±åˆãƒã‚§ãƒƒã‚¯
                if (window.yourNewsApp && typeof AIEngine !== 'undefined') {
                    console.log('Phase Cæ©Ÿèƒ½çµ±åˆç¢ºèª: AI Engineåˆ©ç”¨å¯èƒ½');
                    
                    // AI EngineåˆæœŸåŒ–
                    window.yourNewsApp.aiEngine = new AIEngine();
                    await window.yourNewsApp.aiEngine.initialize();
                    
                    // AIçŠ¶æ…‹è¡¨ç¤ºæ›´æ–°
                    const aiStatusBar = document.getElementById('aiStatusBar');
                    const aiStatusText = document.getElementById('aiStatusText');
                    
                    if (aiStatusBar && aiStatusText) {
                        aiStatusBar.classList.remove('hidden');
                        aiStatusText.textContent = 'ğŸ¤– AIæ©Ÿèƒ½æº–å‚™å®Œäº†';
                        aiStatusBar.className = 'ai-status-bar';
                        
                        setTimeout(() => {
                            aiStatusBar.classList.add('hidden');
                        }, 3000);
                    }
                    
                    // AIæ¨å¥¨è¨˜äº‹ç”Ÿæˆ
                    await setupAIFeatures();
                }
                
                // PWAæ©Ÿèƒ½åˆæœŸåŒ–
                window.yourNewsApp.pwaManager = new PWAManager();
                await window.yourNewsApp.pwaManager.initialize();
                
                // Phase Cé«˜åº¦æ¤œç´¢æ©Ÿèƒ½
                setupAdvancedSearch();
                
                // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
                setupPerformanceMonitoring();
                
            } catch (error) {
                console.error('Phase Cæ©Ÿèƒ½çµ±åˆã‚¨ãƒ©ãƒ¼:', error);
            }
        });
        
        async function setupAIFeatures() {
            try {
                if (!window.yourNewsApp.aiEngine) return;
                
                // AIå†å­¦ç¿’ãƒœã‚¿ãƒ³
                const aiRetrainBtn = document.getElementById('aiRetrainBtn');
                if (aiRetrainBtn) {
                    aiRetrainBtn.addEventListener('click', async () => {
                        try {
                            aiRetrainBtn.disabled = true;
                            aiRetrainBtn.textContent = 'ğŸ”„';
                            
                            // AIå†å­¦ç¿’å®Ÿè¡Œ
                            const articles = await window.yourNewsApp.dataManager.loadArticles();
                            const keywords = await window.yourNewsApp.dataManager.loadData('yourNews_keywords') || 
                                           { interestWords: [], ngWords: [] };
                            
                            for (const article of articles) {
                                await window.yourNewsApp.aiEngine.calculateInterestScore(article, keywords);
                            }
                            
                            await window.yourNewsApp.dataManager.saveArticles(articles);
                            
                            // UIæ›´æ–°
                            if (window.yourNewsApp.uiController) {
                                await window.yourNewsApp.uiController.loadAndDisplayArticles(true);
                            }
                            
                            window.yourNewsApp.showNotification('AIå†å­¦ç¿’ãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
                            
                        } catch (error) {
                            console.error('AIå†å­¦ç¿’ã‚¨ãƒ©ãƒ¼:', error);
                            window.yourNewsApp.showNotification('AIå†å­¦ç¿’ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                        } finally {
                            aiRetrainBtn.disabled = false;
                            aiRetrainBtn.textContent = 'ğŸ§ ';
                        }
                    });
                }
                
                // AIåˆ†æçµæœè¡¨ç¤º
                updateAIInsights();
                
            } catch (error) {
                console.error('AIæ©Ÿèƒ½è¨­å®šã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        function setupAdvancedSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchSuggestions = document.getElementById('searchSuggestions');
            
            if (searchInput) {
                // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢
                searchInput.addEventListener('input', Utils.debounce(async (e) => {
                    const query = e.target.value.trim();
                    
                    if (query.length > 1) {
                        await performAdvancedSearch(query);
                        showSearchSuggestions(query);
                    } else {
                        hideSearchSuggestions();
                        // å…¨è¨˜äº‹è¡¨ç¤ºã«æˆ»ã™
                        if (window.yourNewsApp.uiController) {
                            window.yourNewsApp.uiController.applyFilters();
                        }
                    }
                }, 300));
                
                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã®å‡¦ç†
                searchInput.addEventListener('focus', () => {
                    if (searchInput.value.trim()) {
                        showSearchSuggestions(searchInput.value.trim());
                    }
                });
                
                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å¤–ã—ã§å€™è£œéè¡¨ç¤º
                document.addEventListener('click', (e) => {
                    if (!searchInput.contains(e.target) && !searchSuggestions.contains(e.target)) {
                        hideSearchSuggestions();
                    }
                });
            }
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒãƒ—
            const filterChips = document.querySelectorAll('.filter-chip');
            filterChips.forEach(chip => {
                chip.addEventListener('click', () => {
                    chip.classList.toggle('active');
                    applyFilterChips();
                });
            });
            
            // è¡¨ç¤ºåˆ‡æ›¿
            const viewBtns = document.querySelectorAll('.view-btn');
            viewBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    viewBtns.forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    
                    const view = e.target.dataset.view;
                    const container = document.getElementById('articlesContainer');
                    if (container) {
                        container.className = `articles-container ${view}-view`;
                    }
                });
            });
        }
        
        async function performAdvancedSearch(query) {
            try {
                if (!window.yourNewsApp.uiController) return;
                
                // é«˜åº¦æ¤œç´¢å®Ÿè¡Œ
                const articles = window.yourNewsApp.uiController.getCurrentArticles();
                const searchResults = articles.filter(article => {
                    const searchText = (article.title + ' ' + article.excerpt + ' ' + article.domain).toLowerCase();
                    return searchText.includes(query.toLowerCase());
                });
                
                // çµæœè¡¨ç¤º
                window.yourNewsApp.uiController.filteredArticles = searchResults;
                window.yourNewsApp.uiController.renderArticles();
                
                // è¨˜äº‹æ•°æ›´æ–°
                updateArticlesCount(searchResults.length, articles.length);
                
            } catch (error) {
                console.error('é«˜åº¦æ¤œç´¢ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        function showSearchSuggestions(query) {
            // æ¤œç´¢å€™è£œè¡¨ç¤º
            const suggestions = [
                'æœ€æ–°æŠ€è¡“',
                'AI ãƒ‹ãƒ¥ãƒ¼ã‚¹',
                'çµŒæ¸ˆå‹•å‘',
                'ã‚¹ãƒãƒ¼ãƒ„çµæœ',
                'ã‚¨ãƒ³ã‚¿ãƒ¡æƒ…å ±'
            ].filter(s => s.toLowerCase().includes(query.toLowerCase()));
            
            const suggestionsContainer = document.getElementById('searchSuggestions');
            if (suggestionsContainer && suggestions.length > 0) {
                suggestionsContainer.innerHTML = suggestions.map(s => 
                    `<div class="suggestion-item" onclick="selectSuggestion('${s}')">${s}</div>`
                ).join('');
                suggestionsContainer.style.display = 'block';
            }
        }
        
        function hideSearchSuggestions() {
            const suggestionsContainer = document.getElementById('searchSuggestions');
            if (suggestionsContainer) {
                suggestionsContainer.style.display = 'none';
            }
        }
        
        function selectSuggestion(suggestion) {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.value = suggestion;
                performAdvancedSearch(suggestion);
            }
            hideSearchSuggestions();
        }
        
        function applyFilterChips() {
            const activeChips = document.querySelectorAll('.filter-chip.active');
            const filters = Array.from(activeChips).map(chip => chip.dataset.filter);
            
            console.log('ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼:', filters);
            
            if (window.yourNewsApp.uiController) {
                window.yourNewsApp.uiController.applyAdvancedFilters(filters);
            }
        }
        
        function updateArticlesCount(filtered, total) {
            const countElement = document.getElementById('articlesCount');
            const unreadBadge = document.getElementById('unreadBadge');
            
            if (countElement) {
                if (filtered === total) {
                    countElement.textContent = `${total}ä»¶ã®è¨˜äº‹`;
                } else {
                    countElement.textContent = `${filtered}ä»¶ã®è¨˜äº‹ï¼ˆå…¨${total}ä»¶ä¸­ï¼‰`;
                }
            }
            
            // æœªèª­ä»¶æ•°ãƒãƒƒã‚¸æ›´æ–°
            if (unreadBadge && window.yourNewsApp.uiController) {
                const unreadCount = window.yourNewsApp.uiController.getUnreadCount();
                unreadBadge.textContent = unreadCount;
                unreadBadge.style.display = unreadCount > 0 ? 'inline' : 'none';
            }
        }
        
        async function updateAIInsights() {
            try {
                if (!window.yourNewsApp.aiEngine) return;
                
                const insights = document.getElementById('aiInsights');
                const insightsContent = document.getElementById('insightsContent');
                
                if (insights && insightsContent) {
                    const stats = window.yourNewsApp.aiEngine.getStats();
                    
                    insightsContent.innerHTML = `
                        <div class="insight-item">
                            <span>ğŸ“Š</span>
                            <span>å­¦ç¿’æ¸ˆã¿èªå½™: ${stats.vocabularySize}èª</span>
                        </div>
                        <div class="insight-item">
                            <span>ğŸ“ˆ</span>
                            <span>ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å±¥æ­´: ${stats.feedbackCount}ä»¶</span>
                        </div>
                        <div class="insight-item">
                            <span>ğŸ¯</span>
                            <span>AIåˆ†æç²¾åº¦: ${Math.round(stats.avgIDF * 100)}%</span>
                        </div>
                        <div class="insight-item">
                            <span>ğŸ”¥</span>
                            <span>æ¨å¥¨è¨˜äº‹: ${stats.recommendedCount || 0}ä»¶</span>
                        </div>
                    `;
                    
                    insights.style.display = 'block';
                }
                
            } catch (error) {
                console.error('AIåˆ†æçµæœæ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        function setupPerformanceMonitoring() {
            // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
            let renderStartTime = 0;
            let aiProcessStartTime = 0;
            
            // è¨˜äº‹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–‹å§‹
            window.addEventListener('articlesRenderStart', () => {
                renderStartTime = performance.now();
            });
            
            // è¨˜äº‹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å®Œäº†
            window.addEventListener('articlesRenderComplete', () => {
                const renderTime = Math.round(performance.now() - renderStartTime);
                const renderTimeElement = document.getElementById('renderTime');
                if (renderTimeElement) {
                    renderTimeElement.textContent = renderTime;
                }
                
                // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™è¡¨ç¤º
                const indicator = document.getElementById('performanceIndicator');
                if (indicator) {
                    indicator.classList.add('show');
                    setTimeout(() => {
                        indicator.classList.remove('show');
                    }, 3000);
                }
            });
            
            // AIå‡¦ç†æ™‚é–“ç›£è¦–
            window.addEventListener('aiProcessStart', () => {
                aiProcessStartTime = performance.now();
            });
            
            window.addEventListener('aiProcessComplete', () => {
                const aiProcessTime = Math.round(performance.now() - aiProcessStartTime);
                const aiProcessTimeElement = document.getElementById('aiProcessTime');
                if (aiProcessTimeElement) {
                    aiProcessTimeElement.textContent = aiProcessTime;
                }
            });
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
        window.selectSuggestion = selectSuggestion;
        
        // PWAãƒ‡ãƒãƒƒã‚°é–¢æ•°
        window.debugPWA = function() {
            console.log('=== PWA Debug Information ===');
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    console.log('Service Worker registrations:', registrations.length);
                    registrations.forEach((registration, index) => {
                        console.log(`SW ${index}:`, {
                            scope: registration.scope,
                            state: registration.active?.state,
                            updateFound: !!registration.installing
                        });
                    });
                });
            }
            
            if ('caches' in window) {
                caches.keys().then(cacheNames => {
                    console.log('Cache storages:', cacheNames);
                });
            }
            
            const pwaInfo = {
                standalone: window.matchMedia('(display-mode: standalone)').matches,
                online: navigator.onLine,
                installPrompt: window.yourNewsApp?.pwaManager?.deferredPrompt ? 'Available' : 'Not available'
            };
            console.log('PWAçŠ¶æ…‹:', pwaInfo);
            
            console.log('=== PWA Debug Complete ===');
        };
    </script>
</body>
</html>
