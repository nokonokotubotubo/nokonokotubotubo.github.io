<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="è¨­å®šç”»é¢ - ã‚ãªãŸã®ãƒ‹ãƒ¥ãƒ¼ã‚¹">
    <title>è¨­å®š - ã‚ãªãŸã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</title>
    
    <!-- PWAè¨­å®š -->
    <meta name="theme-color" content="#2196F3">
    <link rel="manifest" href="../assets/manifest.json">
    
    <!-- TensorFlow.js CDNï¼ˆä»•æ§˜æ›¸æŒ‡å®šv4.10.0ï¼‰ -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    
    <!-- ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ -->
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/responsive.css">
    <link rel="stylesheet" href="../styles/components.css">
    <link rel="stylesheet" href="../styles/themes.css">
    
    <!-- è¨­å®šç”»é¢å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
        .settings-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .settings-section {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .section-title {
            color: #333;
            margin: 0 0 1.5rem 0;
            font-size: 1.3rem;
            font-weight: 600;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 0.5rem;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .setting-item:last-child {
            border-bottom: none;
        }
        
        .setting-info {
            flex: 1;
            margin-right: 1rem;
        }
        
        .setting-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.3rem;
        }
        
        .setting-description {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }
        
        .setting-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 25px;
            background: #ddd;
            border-radius: 25px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .toggle-switch.active {
            background: #4CAF50;
        }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 21px;
            height: 21px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .toggle-switch.active::after {
            transform: translateX(25px);
        }
        
        .setting-input {
            padding: 0.5rem;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
            min-width: 100px;
        }
        
        .setting-input:focus {
            outline: none;
            border-color: #2196F3;
        }
        
        .setting-select {
            padding: 0.5rem;
            border: 2px solid #ddd;
            border-radius: 4px;
            background: white;
            font-size: 0.9rem;
            min-width: 120px;
        }
        
        .setting-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .btn-primary {
            background: #2196F3;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1976D2;
        }
        
        .btn-secondary {
            background: #666;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #555;
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-danger:hover {
            background: #d32f2f;
        }
        
        .keyword-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .keyword-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.3rem 0.5rem;
            margin: 0.2rem 0;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .keyword-text {
            flex: 1;
            color: #333;
        }
        
        .keyword-remove {
            background: #f44336;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 0.2rem 0.5rem;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .keyword-input-group {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .keyword-input {
            flex: 1;
            padding: 0.5rem;
            border: 2px solid #ddd;
            border-radius: 4px;
        }
        
        .add-keyword-btn {
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.5rem 1rem;
            cursor: pointer;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .stat-card {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 1rem;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2196F3;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .danger-zone {
            background: #fff5f5;
            border: 1px solid #fed7d7;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .danger-zone .section-title {
            color: #e53e3e;
            border-bottom-color: #fed7d7;
        }
        
        .import-export-area {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .file-input {
            display: none;
        }
        
        .file-label {
            background: #607D8B;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .file-label:hover {
            background: #455A64;
        }
        
        .theme-preview {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .theme-option {
            padding: 1rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            min-width: 120px;
            transition: all 0.2s ease;
        }
        
        .theme-option.active {
            border-color: #2196F3;
            background: #f0f8ff;
        }
        
        .theme-option:hover {
            border-color: #ccc;
        }
        
        .theme-name {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .theme-sample {
            width: 100%;
            height: 40px;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }
        
        .theme-light .theme-sample {
            background: linear-gradient(45deg, #fff, #f0f0f0);
        }
        
        .theme-dark .theme-sample {
            background: linear-gradient(45deg, #333, #555);
        }
        
        .theme-sepia .theme-sample {
            background: linear-gradient(45deg, #f4f1ea, #e8e2d5);
        }
        
        .ai-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
        }
        
        .status-indicator.active {
            background: #4CAF50;
        }
        
        .status-indicator.error {
            background: #f44336;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 0.5rem 0;
        }
        
        .progress-fill {
            height: 100%;
            background: #2196F3;
            transition: width 0.3s ease;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .settings-container {
                padding: 1rem;
            }
            
            .setting-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .setting-control {
                width: 100%;
                justify-content: flex-end;
            }
            
            .import-export-area {
                flex-direction: column;
                align-items: stretch;
            }
            
            .theme-preview {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .theme-preview {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ -->
    <header class="main-header">
        <div class="header-container">
            <h1 class="app-title">ã‚ãªãŸã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ - è¨­å®š</h1>
            <nav class="main-nav">
                <button class="nav-btn" onclick="location.href='../index.html'">è¨˜äº‹ä¸€è¦§</button>
                <button class="nav-btn" onclick="location.href='rss-manager.html'">RSSç®¡ç†</button>
                <button class="nav-btn" onclick="location.href='favorites.html'">ãŠæ°—ã«å…¥ã‚Š</button>
                <button class="nav-btn active">è¨­å®š</button>
            </nav>
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="settings-container">
        <!-- AIãƒ»å­¦ç¿’è¨­å®š -->
        <section class="settings-section">
            <h2 class="section-title">ğŸ¤– AIãƒ»å­¦ç¿’è¨­å®š</h2>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">AIè¨˜äº‹æ¨è–¦æ©Ÿèƒ½</div>
                    <div class="setting-description">è¨˜äº‹ã®èˆˆå‘³åº¦ã‚’è‡ªå‹•ã§è¨ˆç®—ã—ã€ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸè¨˜äº‹æ¨è–¦ã‚’è¡Œã„ã¾ã™</div>
                </div>
                <div class="setting-control">
                    <div class="toggle-switch active" id="aiEnabled"></div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">è‡ªå‹•å­¦ç¿’æ©Ÿèƒ½</div>
                    <div class="setting-description">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ã„ã¦AIãƒ¢ãƒ‡ãƒ«ã‚’è‡ªå‹•çš„ã«æ›´æ–°ã—ã¾ã™</div>
                </div>
                <div class="setting-control">
                    <div class="toggle-switch active" id="autoLearning"></div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">å­¦ç¿’æ„Ÿåº¦</div>
                    <div class="setting-description">AIã®å­¦ç¿’é€Ÿåº¦ã‚’èª¿æ•´ã—ã¾ã™ï¼ˆé«˜æ„Ÿåº¦ã»ã©æ—©ãå­¦ç¿’ã—ã¾ã™ãŒã€èª¤å­¦ç¿’ã®ãƒªã‚¹ã‚¯ã‚‚å¢—ãˆã¾ã™ï¼‰</div>
                </div>
                <div class="setting-control">
                    <select class="setting-select" id="learningSensitivity">
                        <option value="low">ä½æ„Ÿåº¦ï¼ˆæ…é‡ï¼‰</option>
                        <option value="medium" selected>ä¸­æ„Ÿåº¦ï¼ˆãƒãƒ©ãƒ³ã‚¹ï¼‰</option>
                        <option value="high">é«˜æ„Ÿåº¦ï¼ˆç©æ¥µçš„ï¼‰</option>
                    </select>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">AIãƒ¢ãƒ‡ãƒ«çŠ¶æ…‹</div>
                    <div class="setting-description">ç¾åœ¨ã®AIå­¦ç¿’çŠ¶æ³ã¨æ€§èƒ½æŒ‡æ¨™</div>
                </div>
                <div class="setting-control">
                    <div class="ai-status">
                        <div class="status-indicator active" id="aiStatusIndicator"></div>
                        <span id="aiStatusText">å‹•ä½œä¸­</span>
                        <button class="setting-btn btn-secondary" id="resetAIBtn">ãƒªã‚»ãƒƒãƒˆ</button>
                    </div>
                </div>
            </div>
            
            <div class="stats-grid" id="aiStats">
                <div class="stat-card">
                    <div class="stat-value" id="feedbackCount">0</div>
                    <div class="stat-label">å­¦ç¿’æ¸ˆã¿ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="vocabularySize">0</div>
                    <div class="stat-label">èªå½™æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="accuracyScore">0%</div>
                    <div class="stat-label">äºˆæ¸¬ç²¾åº¦</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="lastLearning">æœªå®Ÿè¡Œ</div>
                    <div class="stat-label">æœ€çµ‚å­¦ç¿’</div>
                </div>
            </div>
        </section>

        <!-- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¨­å®š -->
        <section class="settings-section">
            <h2 class="section-title">ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¨­å®š</h2>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">èˆˆå‘³ã®ã‚ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</div>
                    <div class="setting-description">ã“ã‚Œã‚‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€è¨˜äº‹ã®èˆˆå‘³åº¦ãŒé«˜ããªã‚Šã¾ã™</div>
                    <div class="keyword-list" id="interestKeywordsList">
                        <!-- å‹•çš„ã«ç”Ÿæˆ -->
                    </div>
                    <div class="keyword-input-group">
                        <input type="text" class="keyword-input" id="interestKeywordInput" 
                               placeholder="èˆˆå‘³ã®ã‚ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
                        <button class="add-keyword-btn" id="addInterestKeywordBtn">è¿½åŠ </button>
                    </div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">NGã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</div>
                    <div class="setting-description">ã“ã‚Œã‚‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€è¨˜äº‹ã¯è‡ªå‹•çš„ã«éè¡¨ç¤ºã«ãªã‚Šã¾ã™</div>
                    <div class="keyword-list" id="ngKeywordsList">
                        <!-- å‹•çš„ã«ç”Ÿæˆ -->
                    </div>
                    <div class="keyword-input-group">
                        <input type="text" class="keyword-input" id="ngKeywordInput" 
                               placeholder="NGã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
                        <button class="add-keyword-btn" id="addNgKeywordBtn">è¿½åŠ </button>
                    </div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒã‚¤ãƒ©ã‚¤ãƒˆ</div>
                    <div class="setting-description">ä¸€è‡´ã—ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’è¨˜äº‹å†…ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤ºã—ã¾ã™</div>
                </div>
                <div class="setting-control">
                    <div class="toggle-switch active" id="keywordHighlight"></div>
                </div>
            </div>
        </section>

        <!-- è¡¨ç¤ºè¨­å®š -->
        <section class="settings-section">
            <h2 class="section-title">ğŸ¨ è¡¨ç¤ºè¨­å®š</h2>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">ãƒ†ãƒ¼ãƒ</div>
                    <div class="setting-description">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å¤–è¦³ãƒ†ãƒ¼ãƒã‚’é¸æŠã—ã¾ã™</div>
                    <div class="theme-preview">
                        <div class="theme-option theme-light active" data-theme="light">
                            <div class="theme-name">ãƒ©ã‚¤ãƒˆ</div>
                            <div class="theme-sample"></div>
                        </div>
                        <div class="theme-option theme-dark" data-theme="dark">
                            <div class="theme-name">ãƒ€ãƒ¼ã‚¯</div>
                            <div class="theme-sample"></div>
                        </div>
                        <div class="theme-option theme-sepia" data-theme="sepia">
                            <div class="theme-name">ã‚»ãƒ”ã‚¢</div>
                            <div class="theme-sample"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">è¨˜äº‹è¡¨ç¤ºä»¶æ•°</div>
                    <div class="setting-description">ä¸€åº¦ã«è¡¨ç¤ºã™ã‚‹è¨˜äº‹ã®ä»¶æ•°</div>
                </div>
                <div class="setting-control">
                    <select class="setting-select" id="articlesPerPage">
                        <option value="10">10ä»¶</option>
                        <option value="20">20ä»¶</option>
                        <option value="50" selected>50ä»¶</option>
                        <option value="100">100ä»¶</option>
                    </select>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">è¨˜äº‹ã‚«ãƒ¼ãƒ‰ã‚µã‚¤ã‚º</div>
                    <div class="setting-description">è¨˜äº‹ã‚«ãƒ¼ãƒ‰ã®è¡¨ç¤ºã‚µã‚¤ã‚º</div>
                </div>
                <div class="setting-control">
                    <select class="setting-select" id="cardSize">
                        <option value="compact">ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ</option>
                        <option value="normal" selected>æ¨™æº–</option>
                        <option value="large">å¤§ãã‚</option>
                    </select>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">ç”»åƒã®è‡ªå‹•èª­ã¿è¾¼ã¿</div>
                    <div class="setting-description">è¨˜äº‹ã®ç”»åƒã‚’è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¿ã¾ã™ï¼ˆãƒ‡ãƒ¼ã‚¿ä½¿ç”¨é‡ã«æ³¨æ„ï¼‰</div>
                </div>
                <div class="setting-control">
                    <div class="toggle-switch active" id="autoLoadImages"></div>
                </div>
            </div>
        </section>

        <!-- ãƒ‡ãƒ¼ã‚¿ç®¡ç†è¨­å®š -->
        <section class="settings-section">
            <h2 class="section-title">ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ç®¡ç†è¨­å®š</h2>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">è‡ªå‹•ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—</div>
                    <div class="setting-description">å¤ã„è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•çš„ã«å‰Šé™¤ã—ã¾ã™</div>
                </div>
                <div class="setting-control">
                    <div class="toggle-switch active" id="autoCleanup"></div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">ãƒ‡ãƒ¼ã‚¿ä¿æŒæœŸé–“</div>
                    <div class="setting-description">è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹æœŸé–“</div>
                </div>
                <div class="setting-control">
                    <select class="setting-select" id="dataRetentionDays">
                        <option value="3">3æ—¥</option>
                        <option value="7" selected>1é€±é–“</option>
                        <option value="14">2é€±é–“</option>
                        <option value="30">1ãƒ¶æœˆ</option>
                    </select>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">æœ€å¤§è¨˜äº‹ä¿å­˜æ•°</div>
                    <div class="setting-description">ä¿å­˜ã™ã‚‹è¨˜äº‹ã®æœ€å¤§ä»¶æ•°</div>
                </div>
                <div class="setting-control">
                    <input type="number" class="setting-input" id="maxArticles" 
                           value="1000" min="100" max="5000" step="100">
                </div>
            </div>
            
            <div class="stats-grid" id="storageStats">
                <div class="stat-card">
                    <div class="stat-value" id="totalArticles">0</div>
                    <div class="stat-label">ä¿å­˜ä¸­è¨˜äº‹æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="storageUsed">0KB</div>
                    <div class="stat-label">ä½¿ç”¨å®¹é‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="lastCleanup">æœªå®Ÿè¡Œ</div>
                    <div class="stat-label">æœ€çµ‚ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="rssCount">0</div>
                    <div class="stat-label">RSSç™»éŒ²æ•°</div>
                </div>
            </div>
        </section>

        <!-- RSSæ›´æ–°è¨­å®š -->
        <section class="settings-section">
            <h2 class="section-title">ğŸ“¡ RSSæ›´æ–°è¨­å®š</h2>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">è‡ªå‹•æ›´æ–°</div>
                    <div class="setting-description">å®šæœŸçš„ã«RSSãƒ•ã‚£ãƒ¼ãƒ‰ã‚’æ›´æ–°ã—ã¾ã™</div>
                </div>
                <div class="setting-control">
                    <div class="toggle-switch" id="autoRefresh"></div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">æ›´æ–°é–“éš”</div>
                    <div class="setting-description">RSSæ›´æ–°ã®å®Ÿè¡Œé–“éš”</div>
                </div>
                <div class="setting-control">
                    <select class="setting-select" id="refreshInterval">
                        <option value="15">15åˆ†</option>
                        <option value="30" selected>30åˆ†</option>
                        <option value="60">1æ™‚é–“</option>
                        <option value="180">3æ™‚é–“</option>
                        <option value="360">6æ™‚é–“</option>
                    </select>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">æ›´æ–°å¤±æ•—æ™‚ã®å†è©¦è¡Œ</div>
                    <div class="setting-description">RSSå–å¾—ãŒå¤±æ•—ã—ãŸå ´åˆã®å†è©¦è¡Œå›æ•°</div>
                </div>
                <div class="setting-control">
                    <select class="setting-select" id="retryCount">
                        <option value="1">1å›</option>
                        <option value="2" selected>2å›</option>
                        <option value="3">3å›</option>
                        <option value="5">5å›</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ»ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ -->
        <section class="settings-section">
            <h2 class="section-title">ğŸ“‚ ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</h2>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">è¨­å®šãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</div>
                    <div class="setting-description">ç¾åœ¨ã®è¨­å®šã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã—ã¾ã™</div>
                </div>
                <div class="setting-control">
                    <div class="import-export-area">
                        <button class="setting-btn btn-primary" id="exportSettingsBtn">è¨­å®šã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                        <button class="setting-btn btn-primary" id="exportAllDataBtn">å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                    </div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-info">
                    <div class="setting-label">ãƒ‡ãƒ¼ã‚¿ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</div>
                    <div class="setting-description">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã—ã¾ã™</div>
                </div>
                <div class="setting-control">
                    <div class="import-export-area">
                        <label for="importFile" class="file-label">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</label>
                        <input type="file" id="importFile" class="file-input" accept=".json">
                        <button class="setting-btn btn-secondary" id="importDataBtn" disabled>ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- è©³ç´°è¨­å®šãƒ»å±é™ºæ“ä½œ -->
        <section class="settings-section">
            <div class="danger-zone">
                <h2 class="section-title">âš ï¸ è©³ç´°è¨­å®šãƒ»ãƒªã‚»ãƒƒãƒˆæ“ä½œ</h2>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªã‚¢</div>
                        <div class="setting-description">AIã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã€åˆæœŸçŠ¶æ…‹ã«æˆ»ã—ã¾ã™</div>
                    </div>
                    <div class="setting-control">
                        <button class="setting-btn btn-danger" id="clearLearningDataBtn">å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢</button>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªã‚¢</div>
                        <div class="setting-description">ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™</div>
                    </div>
                    <div class="setting-control">
                        <button class="setting-btn btn-danger" id="clearArticleDataBtn">è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢</button>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">å®Œå…¨ãƒªã‚»ãƒƒãƒˆ</div>
                        <div class="setting-description">ã™ã¹ã¦ã®è¨­å®šãƒ»ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã€ã‚¢ãƒ—ãƒªã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã—ã¾ã™</div>
                    </div>
                    <div class="setting-control">
                        <button class="setting-btn btn-danger" id="fullResetBtn">å®Œå…¨ãƒªã‚»ãƒƒãƒˆ</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã‚¨ãƒªã‚¢ -->
    <div class="notification-area" id="notificationArea"></div>

    <!-- ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿ -->
    <script src="../scripts/data-manager.js"></script>
    <script src="../scripts/utils.js"></script>
    <script src="../scripts/ai-engine.js"></script>
    
    <!-- è¨­å®šç”»é¢å°‚ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script>
        class SettingsManager {
            constructor() {
                this.dataManager = null;
                this.aiEngine = null;
                this.defaultSettings = {
                    ai: {
                        enabled: true,
                        autoLearning: true,
                        learningSensitivity: 'medium'
                    },
                    keywords: {
                        interestWords: ['æŠ€è¡“', 'AI', 'ãƒ‹ãƒ¥ãƒ¼ã‚¹'],
                        ngWords: ['åºƒå‘Š', 'PR', 'ã‚¹ãƒãƒ³ã‚µãƒ¼'],
                        highlightEnabled: true
                    },
                    display: {
                        theme: 'light',
                        articlesPerPage: 50,
                        cardSize: 'normal',
                        autoLoadImages: true
                    },
                    data: {
                        autoCleanup: true,
                        retentionDays: 7,
                        maxArticles: 1000
                    },
                    rss: {
                        autoRefresh: false,
                        refreshInterval: 30,
                        retryCount: 2
                    }
                };
                this.currentSettings = {};
            }
            
            async initialize() {
                try {
                    console.log('Settings ManageråˆæœŸåŒ–é–‹å§‹');
                    
                    // ä¾å­˜ã‚¯ãƒ©ã‚¹åˆæœŸåŒ–
                    this.dataManager = new DataManager();
                    await this.dataManager.initialize();
                    
                    if (typeof AIEngine !== 'undefined') {
                        this.aiEngine = new AIEngine();
                        await this.aiEngine.initialize();
                    }
                    
                    // è¨­å®šèª­ã¿è¾¼ã¿
                    await this.loadSettings();
                    
                    // UIåˆæœŸåŒ–
                    this.setupEventListeners();
                    this.updateUI();
                    this.updateStats();
                    
                    console.log('Settings ManageråˆæœŸåŒ–å®Œäº†');
                    
                } catch (error) {
                    console.error('Settings ManageråˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                    this.showNotification('è¨­å®šç”»é¢ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
            
            async loadSettings() {
                try {
                    const savedSettings = Utils.getStorageItem('yourNews_settings');
                    this.currentSettings = savedSettings ? 
                        this.mergeSettings(this.defaultSettings, savedSettings) : 
                        { ...this.defaultSettings };
                    
                    console.log('è¨­å®šèª­ã¿è¾¼ã¿å®Œäº†:', this.currentSettings);
                } catch (error) {
                    console.error('è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                    this.currentSettings = { ...this.defaultSettings };
                }
            }
            
            async saveSettings() {
                try {
                    Utils.setStorageItem('yourNews_settings', this.currentSettings);
                    console.log('è¨­å®šä¿å­˜å®Œäº†');
                    return true;
                } catch (error) {
                    console.error('è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
                    return false;
                }
            }
            
            mergeSettings(defaults, saved) {
                const merged = { ...defaults };
                
                Object.keys(saved).forEach(section => {
                    if (merged[section]) {
                        merged[section] = { ...merged[section], ...saved[section] };
                    } else {
                        merged[section] = saved[section];
                    }
                });
                
                return merged;
            }
            
            setupEventListeners() {
                try {
                    // ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒ
                    this.setupToggleSwitch('aiEnabled', 'ai.enabled');
                    this.setupToggleSwitch('autoLearning', 'ai.autoLearning');
                    this.setupToggleSwitch('keywordHighlight', 'keywords.highlightEnabled');
                    this.setupToggleSwitch('autoLoadImages', 'display.autoLoadImages');
                    this.setupToggleSwitch('autoCleanup', 'data.autoCleanup');
                    this.setupToggleSwitch('autoRefresh', 'rss.autoRefresh');
                    
                    // ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹
                    this.setupSelect('learningSensitivity', 'ai.learningSensitivity');
                    this.setupSelect('articlesPerPage', 'display.articlesPerPage');
                    this.setupSelect('cardSize', 'display.cardSize');
                    this.setupSelect('dataRetentionDays', 'data.retentionDays');
                    this.setupSelect('refreshInterval', 'rss.refreshInterval');
                    this.setupSelect('retryCount', 'rss.retryCount');
                    
                    // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
                    this.setupInput('maxArticles', 'data.maxArticles', 'number');
                    
                    // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç®¡ç†
                    this.setupKeywordManagement();
                    
                    // ãƒ†ãƒ¼ãƒé¸æŠ
                    this.setupThemeSelection();
                    
                    // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                    this.setupButtonEvents();
                    
                    // ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                    this.setupFileImport();
                    
                    console.log('Settings Manager ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®šå®Œäº†');
                    
                } catch (error) {
                    console.error('ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®šã‚¨ãƒ©ãƒ¼:', error);
                }
            }
            
            setupToggleSwitch(elementId, settingPath) {
                const element = document.getElementById(elementId);
                if (!element) return;
                
                element.addEventListener('click', () => {
                    const currentValue = this.getSetting(settingPath);
                    const newValue = !currentValue;
                    this.setSetting(settingPath, newValue);
                    this.updateToggleUI(element, newValue);
                    this.saveSettings();
                });
            }
            
            setupSelect(elementId, settingPath) {
                const element = document.getElementById(elementId);
                if (!element) return;
                
                element.addEventListener('change', (e) => {
                    let value = e.target.value;
                    
                    // æ•°å€¤ã®å ´åˆã¯å¤‰æ›
                    if (!isNaN(value) && value !== '') {
                        value = parseInt(value);
                    }
                    
                    this.setSetting(settingPath, value);
                    this.saveSettings();
                });
            }
            
            setupInput(elementId, settingPath, type = 'text') {
                const element = document.getElementById(elementId);
                if (!element) return;
                
                element.addEventListener('change', (e) => {
                    let value = e.target.value;
                    
                    if (type === 'number') {
                        value = parseInt(value) || 0;
                    }
                    
                    this.setSetting(settingPath, value);
                    this.saveSettings();
                });
            }
            
            setupKeywordManagement() {
                // èˆˆå‘³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¿½åŠ 
                const addInterestBtn = document.getElementById('addInterestKeywordBtn');
                const interestInput = document.getElementById('interestKeywordInput');
                
                if (addInterestBtn && interestInput) {
                    addInterestBtn.addEventListener('click', () => {
                        this.addKeyword('interestWords', interestInput.value.trim());
                        interestInput.value = '';
                    });
                    
                    interestInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            this.addKeyword('interestWords', interestInput.value.trim());
                            interestInput.value = '';
                        }
                    });
                }
                
                // NGã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¿½åŠ 
                const addNgBtn = document.getElementById('addNgKeywordBtn');
                const ngInput = document.getElementById('ngKeywordInput');
                
                if (addNgBtn && ngInput) {
                    addNgBtn.addEventListener('click', () => {
                        this.addKeyword('ngWords', ngInput.value.trim());
                        ngInput.value = '';
                    });
                    
                    ngInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            this.addKeyword('ngWords', ngInput.value.trim());
                            ngInput.value = '';
                        }
                    });
                }
            }
            
            setupThemeSelection() {
                const themeOptions = document.querySelectorAll('.theme-option');
                
                themeOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        const theme = option.dataset.theme;
                        
                        // UIæ›´æ–°
                        themeOptions.forEach(opt => opt.classList.remove('active'));
                        option.classList.add('active');
                        
                        // è¨­å®šä¿å­˜
                        this.setSetting('display.theme', theme);
                        this.saveSettings();
                        
                        // ãƒ†ãƒ¼ãƒé©ç”¨
                        this.applyTheme(theme);
                    });
                });
            }
            
            setupButtonEvents() {
                // AIãƒªã‚»ãƒƒãƒˆ
                const resetAIBtn = document.getElementById('resetAIBtn');
                if (resetAIBtn) {
                    resetAIBtn.addEventListener('click', () => this.resetAIModel());
                }
                
                // ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                const exportSettingsBtn = document.getElementById('exportSettingsBtn');
                if (exportSettingsBtn) {
                    exportSettingsBtn.addEventListener('click', () => this.exportSettings());
                }
                
                const exportAllDataBtn = document.getElementById('exportAllDataBtn');
                if (exportAllDataBtn) {
                    exportAllDataBtn.addEventListener('click', () => this.exportAllData());
                }
                
                // å±é™ºæ“ä½œ
                const clearLearningDataBtn = document.getElementById('clearLearningDataBtn');
                if (clearLearningDataBtn) {
                    clearLearningDataBtn.addEventListener('click', () => this.clearLearningData());
                }
                
                const clearArticleDataBtn = document.getElementById('clearArticleDataBtn');
                if (clearArticleDataBtn) {
                    clearArticleDataBtn.addEventListener('click', () => this.clearArticleData());
                }
                
                const fullResetBtn = document.getElementById('fullResetBtn');
                if (fullResetBtn) {
                    fullResetBtn.addEventListener('click', () => this.fullReset());
                }
            }
            
            setupFileImport() {
                const fileInput = document.getElementById('importFile');
                const importBtn = document.getElementById('importDataBtn');
                
                if (fileInput) {
                    fileInput.addEventListener('change', (e) => {
                        const file = e.target.files[0];
                        if (importBtn) {
                            importBtn.disabled = !file;
                        }
                    });
                }
                
                if (importBtn) {
                    importBtn.addEventListener('click', () => this.importData());
                }
            }
            
            updateUI() {
                try {
                    // ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒæ›´æ–°
                    this.updateToggleUI(document.getElementById('aiEnabled'), this.getSetting('ai.enabled'));
                    this.updateToggleUI(document.getElementById('autoLearning'), this.getSetting('ai.autoLearning'));
                    this.updateToggleUI(document.getElementById('keywordHighlight'), this.getSetting('keywords.highlightEnabled'));
                    this.updateToggleUI(document.getElementById('autoLoadImages'), this.getSetting('display.autoLoadImages'));
                    this.updateToggleUI(document.getElementById('autoCleanup'), this.getSetting('data.autoCleanup'));
                    this.updateToggleUI(document.getElementById('autoRefresh'), this.getSetting('rss.autoRefresh'));
                    
                    // ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹æ›´æ–°
                    this.updateSelectUI('learningSensitivity', this.getSetting('ai.learningSensitivity'));
                    this.updateSelectUI('articlesPerPage', this.getSetting('display.articlesPerPage'));
                    this.updateSelectUI('cardSize', this.getSetting('display.cardSize'));
                    this.updateSelectUI('dataRetentionDays', this.getSetting('data.retentionDays'));
                    this.updateSelectUI('refreshInterval', this.getSetting('rss.refreshInterval'));
                    this.updateSelectUI('retryCount', this.getSetting('rss.retryCount'));
                    
                    // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ›´æ–°
                    this.updateInputUI('maxArticles', this.getSetting('data.maxArticles'));
                    
                    // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤ºæ›´æ–°
                    this.updateKeywordLists();
                    
                    // ãƒ†ãƒ¼ãƒé¸æŠæ›´æ–°
                    this.updateThemeUI();
                    
                    // AIçŠ¶æ…‹æ›´æ–°
                    this.updateAIStatus();
                    
                } catch (error) {
                    console.error('UIæ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
                }
            }
            
            updateToggleUI(element, value) {
                if (!element) return;
                
                if (value) {
                    element.classList.add('active');
                } else {
                    element.classList.remove('active');
                }
            }
            
            updateSelectUI(elementId, value) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.value = value;
                }
            }
            
            updateInputUI(elementId, value) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.value = value;
                }
            }
            
            updateKeywordLists() {
                this.renderKeywordList('interestKeywordsList', this.getSetting('keywords.interestWords'), 'interestWords');
                this.renderKeywordList('ngKeywordsList', this.getSetting('keywords.ngWords'), 'ngWords');
            }
            
            renderKeywordList(containerId, keywords, type) {
                const container = document.getElementById(containerId);
                if (!container || !Array.isArray(keywords)) return;
                
                container.innerHTML = keywords.map(keyword => `
                    <div class="keyword-item">
                        <span class="keyword-text">${Utils.sanitizeHTML(keyword)}</span>
                        <button class="keyword-remove" onclick="settingsManager.removeKeyword('${type}', '${keyword}')">å‰Šé™¤</button>
                    </div>
                `).join('');
            }
            
            updateThemeUI() {
                const currentTheme = this.getSetting('display.theme');
                const themeOptions = document.querySelectorAll('.theme-option');
                
                themeOptions.forEach(option => {
                    if (option.dataset.theme === currentTheme) {
                        option.classList.add('active');
                    } else {
                        option.classList.remove('active');
                    }
                });
            }
            
            updateAIStatus() {
                const statusIndicator = document.getElementById('aiStatusIndicator');
                const statusText = document.getElementById('aiStatusText');
                
                if (this.aiEngine && this.getSetting('ai.enabled')) {
                    if (statusIndicator) {
                        statusIndicator.className = 'status-indicator active';
                    }
                    if (statusText) {
                        statusText.textContent = 'å‹•ä½œä¸­';
                    }
                } else {
                    if (statusIndicator) {
                        statusIndicator.className = 'status-indicator';
                    }
                    if (statusText) {
                        statusText.textContent = 'ç„¡åŠ¹';
                    }
                }
            }
            
            async updateStats() {
                try {
                    // AIçµ±è¨ˆ
                    if (this.aiEngine) {
                        const aiStats = this.aiEngine.getStats();
                        this.updateStatValue('feedbackCount', aiStats.feedbackCount || 0);
                        this.updateStatValue('vocabularySize', aiStats.vocabularySize || 0);
                        this.updateStatValue('accuracyScore', 'æ¨å®šä¸­');
                        this.updateStatValue('lastLearning', aiStats.feedbackCount > 0 ? 'å®Ÿè¡Œæ¸ˆã¿' : 'æœªå®Ÿè¡Œ');
                    }
                    
                    // ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çµ±è¨ˆ
                    const storageStats = this.dataManager.getStorageStats();
                    this.updateStatValue('totalArticles', storageStats.totalArticles || 0);
                    this.updateStatValue('storageUsed', this.formatBytes(storageStats.usedBytes || 0));
                    this.updateStatValue('lastCleanup', storageStats.lastCleanup || 'æœªå®Ÿè¡Œ');
                    this.updateStatValue('rssCount', storageStats.rssCount || 0);
                    
                } catch (error) {
                    console.error('çµ±è¨ˆæ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
                }
            }
            
            updateStatValue(elementId, value) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = value;
                }
            }
            
            // è¨­å®šå€¤å–å¾—ãƒ»è¨­å®š
            getSetting(path) {
                const keys = path.split('.');
                let value = this.currentSettings;
                
                for (const key of keys) {
                    if (value && typeof value === 'object' && key in value) {
                        value = value[key];
                    } else {
                        return undefined;
                    }
                }
                
                return value;
            }
            
            setSetting(path, value) {
                const keys = path.split('.');
                let target = this.currentSettings;
                
                for (let i = 0; i < keys.length - 1; i++) {
                    const key = keys[i];
                    if (!(key in target) || typeof target[key] !== 'object') {
                        target[key] = {};
                    }
                    target = target[key];
                }
                
                target[keys[keys.length - 1]] = value;
            }
            
            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç®¡ç†
            addKeyword(type, keyword) {
                if (!keyword) return;
                
                const keywords = this.getSetting(`keywords.${type}`) || [];
                
                if (!keywords.includes(keyword)) {
                    keywords.push(keyword);
                    this.setSetting(`keywords.${type}`, keywords);
                    this.saveSettings();
                    this.updateKeywordLists();
                    this.showNotification('ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
                } else {
                    this.showNotification('ã“ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™', 'warning');
                }
            }
            
            removeKeyword(type, keyword) {
                const keywords = this.getSetting(`keywords.${type}`) || [];
                const index = keywords.indexOf(keyword);
                
                if (index > -1) {
                    keywords.splice(index, 1);
                    this.setSetting(`keywords.${type}`, keywords);
                    this.saveSettings();
                    this.updateKeywordLists();
                    this.showNotification('ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'success');
                }
            }
            
            // ãƒ†ãƒ¼ãƒé©ç”¨
            applyTheme(theme) {
                document.documentElement.className = `theme-${theme}`;
                this.showNotification(`ãƒ†ãƒ¼ãƒã‚’ã€Œ${theme}ã€ã«å¤‰æ›´ã—ã¾ã—ãŸ`, 'success');
            }
            
            // AIé–¢é€£æ“ä½œ
            async resetAIModel() {
                if (!confirm('AIã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                    return;
                }
                
                try {
                    if (this.aiEngine) {
                        await this.aiEngine.resetModel();
                    }
                    
                    this.updateStats();
                    this.showNotification('AIå­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ', 'success');
                    
                } catch (error) {
                    console.error('AIãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', error);
                    this.showNotification('AIãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
            
            // ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
            async exportSettings() {
                try {
                    const exportData = {
                        version: '1.0',
                        exportDate: new Date().toISOString(),
                        settings: this.currentSettings,
                        type: 'settings'
                    };
                    
                    this.downloadJSON(exportData, `settings-backup-${new Date().toISOString().split('T')[0]}.json`);
                    this.showNotification('è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
                    
                } catch (error) {
                    console.error('è¨­å®šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                    this.showNotification('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
            
            async exportAllData() {
                try {
                    const articles = await this.dataManager.loadArticles();
                    const rssFeeds = await this.dataManager.loadRssFeeds();
                    
                    const exportData = {
                        version: '1.0',
                        exportDate: new Date().toISOString(),
                        settings: this.currentSettings,
                        articles: articles,
                        rssFeeds: rssFeeds,
                        type: 'full'
                    };
                    
                    this.downloadJSON(exportData, `full-backup-${new Date().toISOString().split('T')[0]}.json`);
                    this.showNotification('å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
                    
                } catch (error) {
                    console.error('å…¨ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                    this.showNotification('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
            
            // ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
            async importData() {
                const fileInput = document.getElementById('importFile');
                const file = fileInput.files[0];
                
                if (!file) return;
                
                try {
                    const text = await file.text();
                    const data = JSON.parse(text);
                    
                    if (!data.version || !data.type) {
                        throw new Error('ç„¡åŠ¹ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™');
                    }
                    
                    if (!confirm('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã‹ï¼Ÿç¾åœ¨ã®è¨­å®šã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚')) {
                        return;
                    }
                    
                    // è¨­å®šå¾©å…ƒ
                    if (data.settings) {
                        this.currentSettings = this.mergeSettings(this.defaultSettings, data.settings);
                        await this.saveSettings();
                    }
                    
                    // è¨˜äº‹ãƒ‡ãƒ¼ã‚¿å¾©å…ƒï¼ˆfull backupã®å ´åˆï¼‰
                    if (data.type === 'full') {
                        if (data.articles) {
                            await this.dataManager.saveArticles(data.articles);
                        }
                        if (data.rssFeeds) {
                            await this.dataManager.saveRssFeeds(data.rssFeeds);
                        }
                    }
                    
                    // UIæ›´æ–°
                    this.updateUI();
                    this.updateStats();
                    
                    this.showNotification('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
                    
                    // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚’ãƒªã‚»ãƒƒãƒˆ
                    fileInput.value = '';
                    document.getElementById('importDataBtn').disabled = true;
                    
                } catch (error) {
                    console.error('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                    this.showNotification('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'error');
                }
            }
            
            // å±é™ºæ“ä½œ
            async clearLearningData() {
                if (!confirm('AIå­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                    return;
                }
                
                try {
                    // AIå­¦ç¿’ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
                    const keysToRemove = ['yourNews_vocabulary', 'yourNews_idf', 'yourNews_feedback', 'yourNews_aiModel'];
                    keysToRemove.forEach(key => localStorage.removeItem(key));
                    
                    // AIã‚¨ãƒ³ã‚¸ãƒ³å†åˆæœŸåŒ–
                    if (this.aiEngine) {
                        await this.aiEngine.resetModel();
                    }
                    
                    this.updateStats();
                    this.showNotification('å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'success');
                    
                } catch (error) {
                    console.error('å­¦ç¿’ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
                    this.showNotification('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
            
            async clearArticleData() {
                if (!confirm('ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                    return;
                }
                
                try {
                    await this.dataManager.saveArticles([]);
                    this.updateStats();
                    this.showNotification('è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'success');
                    
                } catch (error) {
                    console.error('è¨˜äº‹ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
                    this.showNotification('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
            
            async fullReset() {
                if (!confirm('ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã¨è¨­å®šã‚’å‰Šé™¤ã—ã€ã‚¢ãƒ—ãƒªã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                    return;
                }
                
                if (!confirm('æœ¬å½“ã«ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã¾ã™ã€‚')) {
                    return;
                }
                
                try {
                    // localStorageå®Œå…¨ã‚¯ãƒªã‚¢
                    const keysToRemove = Object.keys(localStorage).filter(key => key.startsWith('yourNews_'));
                    keysToRemove.forEach(key => localStorage.removeItem(key));
                    
                    this.showNotification('å®Œå…¨ãƒªã‚»ãƒƒãƒˆã‚’å®Ÿè¡Œã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¾ã™ã€‚', 'success');
                    
                    // 3ç§’å¾Œã«ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰
                    setTimeout(() => {
                        location.reload();
                    }, 3000);
                    
                } catch (error) {
                    console.error('å®Œå…¨ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', error);
                    this.showNotification('ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
            
            // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
            formatBytes(bytes) {
                if (bytes === 0) return '0KB';
                
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + sizes[i];
            }
            
            downloadJSON(data, filename) {
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                URL.revokeObjectURL(url);
            }
            
            showNotification(message, type = 'info', duration = 5000) {
                const notificationArea = document.getElementById('notificationArea');
                if (!notificationArea) return;
                
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    ${message}
                    <button onclick="this.parentElement.remove()" 
                            style="float: right; background: none; border: none; color: white; cursor: pointer; font-size: 1.2em; margin-left: 10px;">Ã—</button>
                `;
                
                notificationArea.appendChild(notification);
                
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.remove();
                    }
                }, duration);
            }
        }
        
        // è¨­å®šç”»é¢åˆæœŸåŒ–
        const settingsManager = new SettingsManager();
        
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                await settingsManager.initialize();
            } catch (error) {
                console.error('è¨­å®šç”»é¢åˆæœŸåŒ–å¤±æ•—:', error);
                
                // åˆæœŸåŒ–å¤±æ•—æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤º
                document.body.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #f44336;">
                        <h2>è¨­å®šç”»é¢ã‚¨ãƒ©ãƒ¼</h2>
                        <p>è¨­å®šç”»é¢ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ</p>
                        <button onclick="location.reload()" style="background: #f44336; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">å†èª­ã¿è¾¼ã¿</button>
                    </div>
                `;
            }
        });
        
        // ãƒ‡ãƒãƒƒã‚°ç”¨é–¢æ•°
        window.debugSettingsManager = function() {
            console.log('=== Settings Manager Debug ===');
            console.log('Manager instance:', typeof settingsManager !== 'undefined');
            console.log('Current settings:', settingsManager.currentSettings);
            console.log('AI Engine available:', !!settingsManager.aiEngine);
            console.log('Data Manager available:', !!settingsManager.dataManager);
            console.log('=== Settings Manager Debug Complete ===');
        };
    </script>
</body>
</html>
